<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tirumakudalu Properties - Premium Real Estate Solutions</title>
    <!-- Clear any invalid session data immediately on page load -->
    <script>
        (function () {
            // Clear invalid session data before any other scripts run
            // This ensures sessions are only valid after successful login
            const hasSessionFlag = sessionStorage.getItem('dashboard_authenticated') === 'true' ||
                localStorage.getItem('dashboard_authenticated') === 'true';

            if (hasSessionFlag) {
                const userStr = sessionStorage.getItem('user') || localStorage.getItem('user');
                let hasValidUser = false;

                if (userStr) {
                    try {
                        const user = JSON.parse(userStr);
                        // Validate user has required fields (email and admin role)
                        if (user &&
                            user.email &&
                            typeof user.email === 'string' &&
                            user.email.trim() !== '' &&
                            user.role === 'admin') {
                            hasValidUser = true;
                        }
                    } catch (e) {
                        // Invalid JSON
                    }
                }

                // If there's a session flag but no valid user, clear it
                if (!hasValidUser) {
                    sessionStorage.removeItem('dashboard_authenticated');
                    sessionStorage.removeItem('isAuthenticated');
                    sessionStorage.removeItem('user');
                    localStorage.removeItem('dashboard_authenticated');
                    localStorage.removeItem('isAuthenticated');
                    localStorage.removeItem('user');
                }
            }
        })();
    </script>
    <link rel="icon" type="image/webp" href="/images/TS_logo.webp">
    <!-- Critical CSS - Inlined for above-the-fold content -->
    <style>
        /* Critical CSS - Above the fold styles only */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box
        }

        :root {
            --black: #000;
            --black-soft: #0a0a0a;
            --black-elevated: #1a1a1a;
            --grey-darkest: #2d2d2d;
            --grey-darker: #3d3d3d;
            --grey-dark: #4a4a4a;
            --grey-medium: #6b6b6b;
            --grey: #8a8a8a;
            --grey-light: #b0b0b0;
            --grey-lighter: #d0d0d0;
            --grey-lightest: #e5e5e5;
            --grey-pale: #f0f0f0;
            --grey-ultra-pale: #f8f8f8;
            --white: #fff;
            --white-off: #fafafa;
            --yellow-muted: #2C3E50;
            --yellow-soft: #1e2a36;
            --yellow-dull: #151c24;
            --yellow-warm: #8B2E3D;
            --yellow-pale: #f5f3f0;
            --yellow-subtle: #e8e5e0;
            --yellow-bright: #2C3E50;
            --yellow-gold: #8B2E3D;
            --purple: #9C27B0;
            --purple-pale: #f3e5f5;
            --purple-light: #e1bee7;
            --primary-color: #2C3E50;
            --primary-dark: #1e2a36;
            --primary-darker: #151c24;
            --primary-light: #8B2E3D;
            --primary-lighter: #e8e5e0;
            --primary-lightest: #f5f3f0;
            --secondary-color: #4a4a4a;
            --accent-color: #8B2E3D;
            --pastel-yellow: #f5f3f0;
            --pastel-grey-light: #f5f5f5;
            --pastel-grey: #eee;
            --pastel-grey-dark: #e0e0e0;
            --text-dark: #1a1a1a;
            --text-gray: #4a4a4a;
            --text-light: #6b6b6b;
            --light-bg: #fafafa;
            --border-color: #e5e5e5;
            --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, .05);
            --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, .1);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, .1);
            --shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, .1);
            --shadow-2xl: 0 25px 50px -12px rgba(0, 0, 0, .25)
        }

        html {
            visibility: hidden;
            overflow-x: hidden;
            width: 100%;
            max-width: 100%
        }

        html.loaded {
            visibility: visible;
        }

        body {
            font-family: 'Inter', system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            font-size: 18px;
            line-height: 1.6;
            color: var(--text-dark);
            overflow-x: hidden;
            width: 100%;
            max-width: 100%;
            box-sizing: border-box
        }

        * {
            box-sizing: border-box
        }

        p {
            font-size: 18px
        }

        h1 {
            font-size: 28px
        }

        h2 {
            font-size: 26px
        }

        h3 {
            font-size: 22px
        }

        h4 {
            font-size: 22px
        }

        h5 {
            font-size: 22px
        }

        h6 {
            font-size: 22px
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
            overflow: visible;
            width: 100%;
            box-sizing: border-box
        }

        @media (max-width:1366px) {
            .container {
                max-width: 100%;
                padding: 0 15px
            }
        }

        @media (max-width:1280px) {
            .container {
                padding: 0 12px
            }
        }

        .top-bar {
            background: var(--black);
            color: var(--white);
            padding: .75rem 0;
            font-size: .875rem
        }

        .top-bar-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 1rem
        }

        .top-bar-left {
            display: flex;
            gap: 2rem;
            flex-wrap: wrap
        }

        .top-bar-left a {
            color: rgba(255, 255, 255, .8);
            text-decoration: none;
            transition: color .3s ease
        }

        .top-bar-left a:hover {
            color: var(--white)
        }

        .top-bar-left i {
            margin-right: .5rem;
            color: var(--accent-color)
        }

        .top-bar-right {
            display: flex;
            gap: 1rem
        }

        .top-bar-right a {
            color: rgba(255, 255, 255, .8);
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: all .3s ease
        }

        .top-bar-right a:hover {
            background: var(--primary-color);
            color: var(--black);
            transform: translateY(-3px) scale(1.1)
        }

        .navbar {
            position: sticky;
            top: 0;
            left: 0;
            right: 0;
            background: var(--white);
            box-shadow: 0 2px 8px rgba(0, 0, 0, .1);
            z-index: 1000;
            transition: all .3s ease;
            min-height: 80px;
        }

        .nav-wrapper {
            display: flex;
            justify-content: flex-start;
            align-items: center;
            padding: 1.25rem 0;
            gap: 3rem;
            flex-wrap: nowrap;
            position: relative
        }

        .logo {
            display: flex;
            align-items: center;
            margin-right: 3.5rem;
            flex-shrink: 0;
            z-index: 1001
        }

        .logo-link {
            display: flex;
            align-items: center;
            gap: 1rem;
            text-decoration: none;
            transition: transform .3s ease
        }

        .logo-img {
            width: 200px;
            height: auto;
            object-fit: contain;
            display: block;
            transition: width .3s ease
        }

        .nav-menu {
            display: flex;
            list-style: none;
            gap: 2rem;
            align-items: center
        }

        .nav-menu a {
            text-decoration: none;
            color: var(--text-dark);
            font-weight: 500;
            font-size: .95rem;
            transition: all .3s cubic-bezier(.68, -.55, .265, 1.55);
            position: relative;
            display: inline-block
        }

        .nav-menu a::after {
            content: '';
            position: absolute;
            bottom: -5px;
            left: 0;
            width: 0;
            height: 2px;
            background: var(--primary-color);
            transition: width .3s ease
        }

        .nav-menu a:hover::after,
        .nav-menu a.active::after {
            width: 100%
        }

        .nav-menu a:hover,
        .nav-menu a.active {
            color: var(--primary-color);
            transform: translateY(-2px)
        }

        .nav-search {
            flex: 1;
            max-width: 300px;
            margin: 0;
            min-width: 0
        }

        .nav-search-wrapper {
            position: relative;
            display: flex;
            align-items: center;
            background: var(--light-bg);
            border: 2px solid var(--border-color);
            border-radius: 25px;
            padding: .5rem 1rem;
            transition: all .3s ease
        }

        .nav-search-wrapper:focus-within {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(171, 184, 195, .2)
        }

        .nav-search-input {
            flex: 1;
            border: none;
            background: transparent;
            outline: none;
            font-size: .9rem;
            color: var(--text-dark);
            font-family: inherit;
            width: 100%
        }

        .nav-actions {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-left: auto;
            flex-shrink: 0
        }

        .btn-login {
            display: inline-flex;
            align-items: center;
            gap: .5rem;
            padding: .625rem 1.25rem;
            background: linear-gradient(135deg, var(--primary-color), var(--primary-dark));
            color: var(--white);
            border: 2px solid transparent;
            border-radius: 8px;
            font-size: .9rem;
            font-weight: 700;
            cursor: pointer;
            transition: all .3s cubic-bezier(.4, 0, .2, 1);
            font-family: inherit;
            box-shadow: 0 2px 8px var(--primary-color);
            position: relative;
            overflow: hidden
        }

        .btn-login:hover {
            background: var(--primary-dark);
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(171, 184, 195, .5)
        }

        .hero {
            position: relative;
            height: min(100vh, 900px);
            min-height: 800px;
            overflow: hidden;
            display: flex;
            align-items: stretch
        }

        .hero-split-container {
            display: grid;
            grid-template-columns: 1fr 2fr;
            width: 100%;
            height: 100%;
            position: relative
        }

        .hero-left-panel {
            background: linear-gradient(135deg, var(--text-dark) 0%, rgba(45, 58, 69, .95) 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            z-index: 2;
            overflow: hidden
        }

        .hero-left-content {
            padding: 4rem 3rem;
            text-align: center;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100%;
            max-width: 500px;
            position: relative;
            z-index: 1
        }

        .hero-main-heading {
            font-family: 'Playfair Display', serif;
            font-size: clamp(26px, 4vw, 28px);
            font-weight: 400;
            color: var(--white);
            line-height: 1.4;
            margin-bottom: 2rem;
            text-transform: uppercase;
            letter-spacing: 2px;
            position: relative
        }

        .hero-sub-heading {
            font-family: 'Inter', sans-serif;
            font-size: 18px;
            font-weight: 300;
            color: var(--white);
            text-transform: uppercase;
            letter-spacing: 3px;
            margin-bottom: 3rem;
            line-height: 1.6;
            text-align: left;
            max-width: 400px;
            position: relative;
            padding-left: 1.5rem
        }

        .hero-sub-heading::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            bottom: 0;
            width: 3px;
            background: var(--white);
            border-radius: 2px
        }

        .hero-right-panel {
            position: relative;
            overflow: hidden;
            background: #fff
        }

        .hero-image-section {
            width: 100%;
            height: 100%;
            opacity: 1 !important;
            visibility: visible !important
        }

        .hero-image-slider {
            width: 100%;
            height: 100%;
            position: relative;
            overflow: hidden
        }

        .hero-slider-track {
            position: relative;
            width: 100%;
            height: 100%
        }

        .hero-slide {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            opacity: 0;
            transition: opacity 1.5s ease-in-out
        }

        .hero-slide.active {
            opacity: 1;
            z-index: 1
        }

        .hero-image-wrapper {
            position: relative;
            width: 100%;
            height: 100%;
            overflow: hidden
        }

        .hero-image-wrapper img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            display: block
        }

        @media (max-width:768px) {
            .top-bar {
                padding: .5rem 0;
                font-size: .75rem
            }

            .top-bar-left {
                gap: 1rem;
                justify-content: center;
                width: 100%
            }

            .logo {
                margin-right: auto
            }

            .logo-img {
                width: 140px
            }

            .nav-wrapper {
                gap: 1rem;
                padding: .875rem 0
            }

            .hero {
                min-height: 100vh
            }

            .hero-left-panel {
                min-height: 350px
            }

            .hero-left-content {
                padding: 2rem 1.5rem
            }

            .hero-main-heading {
                font-size: 1.5rem
            }

            .hero-sub-heading {
                font-size: .75rem;
                margin-bottom: 2rem
            }
        }

        @media (min-width:450px) and (min-height:832px) {
            .hero {
                max-height: 300px;
            }

            .hero-left-panel {
                background-color: var(--primary-color);
                min-height: 300px
            }

            .hero-left-content {
                padding: 2.5rem 2rem
            }
        }
    </style>
    <!-- Main styles loaded normally on index to prevent FOUC -->
    <link rel="stylesheet" href="/css/style.css">
    <!-- Google Fonts - Load asynchronously -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=Playfair+Display:wght@400;600;700&display=swap"
        rel="stylesheet" media="print" onload="this.media='all'">
    <noscript>
        <link
            href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=Playfair+Display:wght@400;600;700&display=swap"
            rel="stylesheet">
    </noscript>
    <!-- Font Awesome - Load asynchronously -->
    <link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" as="style"
        onload="this.onload=null;this.rel='stylesheet'">
    <noscript>
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    </noscript>
</head>

<body>
    <!-- Top Bar -->
    <div class="top-bar">
        <div class="container">
            <div class="top-bar-content">
                <div class="top-bar-left">
                    <a href="tel:+919741111756"><i class="fas fa-phone"></i> +91 97411 11756</a>
                    <a href="mailto:info@tirumakudaluproperties.com"><i class="fas fa-envelope"></i>
                        info@tirumakudaluproperties.com</a>
                </div>
            </div>
        </div>
    </div>

    <!-- Navigation -->
    <nav class="navbar">
        <div class="container">
            <div class="nav-wrapper">
                <div class="logo">
                    <a href="#home" class="logo-link">
                        <div class="logo-graphic">
                            <img src="/images/TS_logo.webp" alt="Tirumakudalu Properties Logo" class="logo-img"
                                loading="lazy">
                        </div>
                    </a>
                </div>
                <ul class="nav-menu" id="navMenu">
                    <li><a href="/index.html" class="active">HOME</a></li>
                    <li><a href="/properties.html">PROPERTIES</a></li>
                    <li><a href="#contact">CONTACT</a></li>
                </ul>
                <div class="nav-search">
                    <div class="nav-search-wrapper">
                        <i class="fas fa-search nav-search-icon"></i>
                        <input type="text" id="navSearchInput" class="nav-search-input"
                            placeholder="Search properties..." autocomplete="off">
                        <button type="button" class="nav-search-clear" id="navSearchClear" style="display: none;">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                </div>
                <div class="nav-actions">
                    <button class="btn-login" id="loginBtn">
                        <i class="fas fa-user"></i>
                        <span>LOGIN</span>
                    </button>
                </div>
                <div class="nav-toggle" id="navToggle">
                    <span></span>
                    <span></span>
                    <span></span>
                </div>
            </div>
        </div>
    </nav>

    <!-- Hero Section - Split Layout -->
    <section class="hero" id="home">
        <div class="hero-split-container">
            <!-- Left Panel - Text Content -->
            <div class="hero-left-panel">
                <div class="hero-left-content">
                    <h1 class="hero-main-heading">
                        <span class="hero-heading-line">TIRUMAKUDALU</span>
                        <span class="hero-heading-line">PROPERTIES</span>
                        <span class="hero-heading-line">PREMIUM</span>
                        <span class="hero-heading-line">REAL ESTATE</span>
                        <span class="hero-heading-line">SOLUTIONS</span>
                    </h1>
                    <p class="hero-sub-heading">YOUR TRUSTED PARTNER IN PROPERTY INVESTMENT & RENTAL SERVICES.</p>
                    <a href="#indexPropertiesFilters" class="hero-scroll-indicator"
                        aria-label="Scroll to filter section">
                        <i class="fas fa-chevron-down"></i>
                    </a>
                </div>
            </div>

            <!-- Right Panel - Image Slider -->
            <div class="hero-right-panel">
                <div class="hero-image-section hero-image-single">
                    <div class="hero-image-slider">
                        <div class="hero-slider-track" id="heroSliderTrack">
                            <div class="hero-slide active">
                                <div class="hero-image-wrapper">
                                    <img src="/images/img1.webp" alt="Modern Apartment" loading="lazy">
                                </div>
                            </div>
                            <div class="hero-slide">
                                <div class="hero-image-wrapper">
                                    <img src="/images/img2.webp" alt="Luxury Property" loading="lazy">
                                </div>
                            </div>
                            <div class="hero-slide">
                                <div class="hero-image-wrapper">
                                    <img src="/images/img3.webp" alt="Premium Real Estate" loading="lazy">
                                </div>
                            </div>
                            <div class="hero-slide">
                                <div class="hero-image-wrapper">
                                    <img src="/images/img4.webp" alt="Beautiful Home" loading="lazy">
                                </div>
                            </div>
                            <div class="hero-slide">
                                <div class="hero-image-wrapper">
                                    <img src="/images/img5.webp" alt="Elegant Property" loading="lazy">
                                </div>
                            </div>
                            <div class="hero-slide">
                                <div class="hero-image-wrapper">
                                    <img src="/images/img.webp" alt="Premium Residence" loading="lazy">
                                </div>
                            </div>
                            <div class="hero-slide">
                                <div class="hero-image-wrapper">
                                    <img src="/images/img.jpg" alt="Luxury Interior" loading="lazy">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
    <hr>


    <!-- Property Filter Section -->
    <section class="property-search" id="indexPropertiesFilters">
        <div class="container">
            <div class="section-header">
                <h2>Find Your Dream Property</h2>
                <p>Search through our extensive collection of properties</p>
            </div>

            <div class="properties-filters">
                <!-- Category Filter with Subcategories -->
                <div class="filter-section category-section-centered" id="indexCategorySection">
                    <div class="category-main-buttons">
                        <button type="button" class="category-text-button" data-category="residential"
                            id="indexFilterResidential">Residential</button>
                        <span class="category-divider">|</span>
                        <button type="button" class="category-text-button" data-category="commercial"
                            id="indexFilterCommercial">Commercial</button>
                    </div>
                    <div class="category-subcategories-container">
                        <div class="subcategory-buttons" data-category="residential" style="display: none;">
                            <button type="button" class="filter-button subcategory-button" data-property-type="plots"
                                data-parent-category="residential" id="indexFilterPlots">Plots</button>
                            <button type="button" class="filter-button subcategory-button"
                                data-property-type="apartment" data-parent-category="residential"
                                id="indexFilterApartments">Apartments</button>
                                                        <button type="button" class="filter-button subcategory-button" data-property-type="villa"
                                data-parent-category="residential" id="indexFilterVillas">Villas</button>
                        </div>
                        <div class="subcategory-buttons" data-category="commercial" style="display: none;">
                            <button type="button" class="filter-button subcategory-button"
                                data-property-type="office-space" data-parent-category="commercial"
                                id="indexFilterOfficeSpace">Office Space</button>
                            <button type="button" class="filter-button subcategory-button"
                                data-property-type="warehouse" data-parent-category="commercial"
                                id="indexFilterWarehouse">Warehouse</button>
                            <button type="button" class="filter-button subcategory-button"
                                data-property-type="showrooms" data-parent-category="commercial"
                                id="indexFilterShowrooms">Showrooms</button>
                        </div>
                    </div>
                </div>

                <!-- Advanced Search Form -->
                <div class="properties-search">
                    <form class="search-form" id="indexPropertiesSearchForm">
                        <div class="search-row">
                            <div class="search-group filter-group" data-filter-for="common">
                                <label><i class="fas fa-map-marker-alt"></i> City</label>
                                <input type="text" id="indexSearchCity" list="indexSearchCityList"
                                    placeholder="Enter City">
                                <datalist id="indexSearchCityList"></datalist>
                            </div>
                            <div class="search-group filter-group" data-filter-for="common">
                                <label><i class="fas fa-map-marker-alt"></i> Area</label>
                                <input type="text" id="indexSearchArea" list="indexSearchAreaList"
                                    placeholder="Enter Area">
                                <datalist id="indexSearchAreaList">
                                    <option value="">Any Area</option>
                                </datalist>
                            </div>
                            <div class="search-group filter-group" data-filter-for="common">
                                <label><i class="fas fa-exchange-alt"></i> Transaction Type</label>
                                <select id="indexSearchTransactionType">
                                    <option value="all">All Properties</option>
                                    <option value="sale">Buy</option>
                                    <option value="rent">Rent</option>
                                </select>
                            </div>
                            <div class="search-group filter-group" data-filter-for="common">
                                <label><i class="fas fa-check-circle"></i> Status</label>
                                <select id="indexSearchPropertyCondition">
                                    <option value="">Any Status</option>
                                    <option value="new">New</option>
                                    <option value="resale">Resale</option>
                                </select>
                            </div>
                            <div class="search-group filter-group" data-filter-for="common">
                                <label>
                                    <span class="currency-symbol">₹</span> Price Range
                                </label>
                                <button type="button" class="price-range-btn" id="indexPriceRangeBtn">
                                    <span class="price-range-display" id="indexPriceRangeDisplay">Any Price</span>
                                    <i class="fas fa-chevron-down"></i>
                                </button>
                                <input type="hidden" id="indexSearchPrice" value="">
                            </div>
                            <!-- Direction: Step 2 only in Apartments (add property modal) -->
                            <div class="search-group filter-group" data-filter-for="apartment">
                                <label><i class="fas fa-compass"></i> Direction</label>
                                <select id="indexSearchDirection">
                                    <option value="">Any Direction</option>
                                    <option value="east">East</option>
                                    <option value="west">West</option>
                                    <option value="north">North</option>
                                    <option value="south">South</option>
                                    <option value="northeast">North East</option>
                                    <option value="northwest">North West</option>
                                    <option value="southeast">South East</option>
                                    <option value="southwest">South West</option>
                                </select>
                            </div>
                            <!-- Amenities: Step 2 in apartment, house, villa, office-space, showrooms, warehouse -->
                            <div class="search-group filter-group" data-filter-for="apartment house villa office-space showrooms warehouse">
                                <label><i class="fas fa-star"></i> Amenities</label>
                                <select id="indexSearchAmenities">
                                    <option value="">Any Amenity</option>
                                </select>
                            </div>
                            <!-- Unit Type: Step 2 in apartment, house, villa -->
                            <div class="search-group filter-group" data-filter-for="apartment house villa">
                                <label><i class="fas fa-home"></i> Unit Type</label>
                                <select id="indexSearchUnitType">
                                    <option value="">Any Unit Type</option>
                                </select>
                            </div>
                            <!-- Villa Type: Step 2 in villa -->
                            <div class="search-group filter-group" data-filter-for="villa">
                                <label><i class="fas fa-home"></i> Villa Type</label>
                                <select id="indexSearchVillaType">
                                    <option value="">Any Villa Type</option>
                                    <option value="independent_villa">Independent Villa</option>
                                    <option value="row_villa">Row Villa</option>
                                    <option value="villament">Villament</option>
                                </select>
                            </div>
                            <!-- Warehouse Type: Step 2 in warehouse -->
                            <div class="search-group filter-group" data-filter-for="warehouse">
                                <label><i class="fas fa-warehouse"></i> Warehouse Type</label>
                                <select id="indexSearchWarehouseType">
                                    <option value="">Any Type</option>
                                    <option value="cold_storage">Cold storage</option>
                                    <option value="industrial">Industrial</option>
                                    <option value="logistic">Logistic</option>
                                </select>
                            </div>
                            <!-- Plot Area: Step 2 in plots, villa, warehouse -->
                            <div class="search-group filter-group" data-filter-for="plots villa warehouse">
                                <label><i class="fas fa-ruler-combined"></i> Plot Area (sq.ft)</label>
                                <input type="number" id="indexSearchPlotArea" placeholder="Min Plot Area">
                            </div>
                            <!-- Length/Breadth: Step 2 in plots, villa, house -->
                            <div class="search-group filter-group" data-filter-for="plots villa house">
                                <label><i class="fas fa-arrows-alt-h"></i> Length (ft)</label>
                                <input type="number" id="indexSearchLength" placeholder="Length">
                            </div>
                            <div class="search-group filter-group" data-filter-for="plots villa house">
                                <label><i class="fas fa-arrows-alt-v"></i> Breadth (ft)</label>
                                <input type="number" id="indexSearchBreadth" placeholder="Breadth">
                            </div>
                            <!-- Super Builtup Area: Step 2 in apartment, office-space, showrooms, warehouse -->
                            <div class="search-group filter-group" data-filter-for="apartment office-space showrooms warehouse">
                                <label><i class="fas fa-ruler-combined"></i> Super Builtup Area (sq.ft)</label>
                                <input type="number" id="indexSearchSuperBuildupArea" placeholder="Min Super Builtup">
                            </div>
                            <!-- Carpet Area: Step 2 in apartment, house, villa, office-space, showrooms, warehouse -->
                            <div class="search-group filter-group"
                                data-filter-for="apartment house villa office-space showrooms warehouse">
                                <label><i class="fas fa-vector-square"></i> Carpet Area (sq.ft)</label>
                                <input type="number" id="indexSearchCarpetArea" placeholder="Min Carpet Area">
                            </div>
                        </div>

                        <div class="filter-button-center">
                            <button type="submit" class="btn-search">
                                <i class="fas fa-search"></i>
                                <span>Filter</span>
                            </button>
                        </div>
                    </form>
                </div>

                <!-- Active Filter Tags -->
                <div class="filter-tags-container" id="indexFilterTagsContainer" style="display: none;">
                    <div class="filter-tags-header">
                        <span class="filter-tags-label">Active:</span>
                        <button type="button" class="clear-all-filters" id="indexClearAllFilters">
                            <i class="fas fa-times-circle"></i>
                        </button>
                    </div>
                    <div class="filter-tags" id="indexFilterTags">
                        <!-- Filter tags will be rendered here by JavaScript -->
                    </div>
                </div>
            </div>
        </div>
    </section>

    <hr>

    <!-- Index Price Range Modal (same structure as properties.html) -->
    <div class="price-range-modal" id="indexPriceRangeModal">
        <div class="price-range-modal-overlay" id="indexPriceRangeModalOverlay"></div>
        <div class="price-range-modal-content">
            <div class="price-range-modal-header">
                <h3>Select Price Range</h3>
                <button type="button" class="price-range-modal-close" id="indexPriceRangeModalClose">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="price-range-modal-body">
                <div class="price-range-slider-container">
                    <div class="price-range-labels">
                        <span class="price-range-label-min" id="indexPriceRangeLabelMin">₹0</span>
                        <span class="price-range-label-max" id="indexPriceRangeLabelMax">₹100+ Cr</span>
                    </div>
                    <div class="price-range-slider-wrapper">
                        <div class="price-range-track" id="indexPriceRangeTrack">
                            <div class="price-range-progress" id="indexPriceRangeProgress"></div>
                            <input type="range" class="price-range-input price-range-input-min"
                                id="indexPriceRangeMin" min="0" max="100" value="0" step="0.1">
                            <input type="range" class="price-range-input price-range-input-max"
                                id="indexPriceRangeMax" min="0" max="100" value="100" step="0.1">
                        </div>
                    </div>
                    <div class="price-range-inputs">
                        <div class="price-range-input-group">
                            <label>Min Price (Cr)</label>
                            <input type="number" class="price-range-number-input" id="indexPriceRangeMinInput"
                                min="0" max="100" step="0.1" value="0">
                        </div>
                        <div class="price-range-input-group">
                            <label>Max Price (Cr)</label>
                            <input type="number" class="price-range-number-input" id="indexPriceRangeMaxInput"
                                min="0" max="100" step="0.1" value="100">
                        </div>
                    </div>
                </div>
            </div>
            <div class="price-range-modal-footer">
                <button type="button" class="price-range-btn-clear" id="indexPriceRangeBtnClear">Clear</button>
                <button type="button" class="price-range-btn-apply" id="indexPriceRangeBtnApply">Apply</button>
            </div>
        </div>
    </div>
    <!-- Property Types -->
    <section class="property-types">
        <div class="container">
            <div class="section-header">
                <h2>Browse by Property Type</h2>
            </div>
            <div class="types-grid">
                <div class="type-card" data-type="apartment">
                    <div class="type-icon">
                        <i class="fas fa-building"></i>
                    </div>
                    <h3>Apartments</h3>
                    <p class="type-count">0 Properties</p>
                </div>
                <div class="type-card" data-type="plot">
                    <div class="type-icon">
                        <i class="fas fa-map"></i>
                    </div>
                    <h3>Plots</h3>
                    <p class="type-count">0 Properties</p>
                </div>
                <div class="type-card" data-type="villa">
                    <div class="type-icon">
                        <i class="fas fa-igloo"></i>
                    </div>
                    <h3>Villas</h3>
                    <p class="type-count">0 Properties</p>
                </div>
            </div>
        </div>
    </section>
    <hr>

    <!-- About Section -->
    <section class="about-compact" id="about">
        <div class="container">
            <div class="section-header">
                <h2>About Us</h2>
            </div>

            <div class="about-compact-content">
                <!-- Introduction -->
                <div class="about-intro-compact">
                    <p class="about-intro-text">Tirumakudalu Properties is the place to be! With over ten years of
                        experience in property-related services, we have established ourselves as one of the industry's
                        leading companies.</p>
                </div>

                <!-- Vision & Mission Cards -->
                <div class="about-vm-compact">
                    <div class="vm-compact-card">
                        <div class="vm-compact-icon">
                            <i class="fas fa-eye"></i>
                        </div>
                        <h3>Vision</h3>
                        <p>To be the most trusted and sought-after real estate and property management company in
                            Bengaluru, recognized for our exceptional customer service, innovative solutions, and
                            unwavering commitment to integrity and transparency.</p>
                    </div>
                    <div class="vm-compact-card">
                        <div class="vm-compact-icon">
                            <i class="fas fa-bullseye"></i>
                        </div>
                        <h3>Mission</h3>
                        <p>To provide exceptional real estate and property management services that exceed expectations
                            by leveraging our deep knowledge of the local market, adopting innovative technologies, and
                            fostering a culture of honesty and transparency.</p>
                    </div>
                </div>
            </div>
        </div>
    </section>
    <hr>

    <!-- Partners Section -->
    <section class="partners-compact" id="partners">
        <div class="container">
            <div class="section-header">
                <h2>Our Partners</h2>
            </div>

            <div class="partners-compact-content">
                <div class="partners-intro-compact">
                    <p>With its strong reputation for professionalism and integrity, Tirumakudalu Properties has
                        established partnerships with some of the most reputed property-related companies in the region.
                        These channel partners help the company to expand its reach and offer a wider range of services
                        to its clients, ensuring that they receive the best possible advice and support.</p>
                </div>

                <div class="partners-compact-grid" id="partnersCompactGrid">
                    <!-- Partners will be rendered here -->
                </div>
                <div class="partners-load-more-container" id="partnersLoadMoreContainer" style="display: none;">
                    <button class="btn-load-more-partners" id="loadMorePartnersBtn">
                        <span>Load More Partners</span>
                        <i class="fas fa-chevron-down"></i>
                    </button>
                </div>
                <div class="partners-show-less-container" id="partnersShowLessContainer" style="display: none;">
                    <button class="btn-show-less-partners" id="showLessPartnersBtn">
                        <span>Show Less</span>
                        <i class="fas fa-chevron-up"></i>
                    </button>
                </div>
            </div>
        </div>
    </section>
    <hr>

    <!-- Testimonials Section -->
    <section class="testimonials-compact" id="testimonials">
        <div class="container">
            <div class="section-header">
                <h2>What Our Clients Say</h2>
            </div>

            <div class="testimonials-compact-content">
                <div class="testimonials-compact-scroll-wrapper">
                    <div class="testimonials-compact-grid" id="testimonialsCompactGrid">
                        <!-- Testimonials will be rendered here -->
                        <div class="testimonials-compact-empty">
                            <div class="testimonials-empty-icon">
                                <i class="fas fa-comments"></i>
                            </div>
                            <h3>Testimonials Coming Soon</h3>
                            <p>We're collecting testimonials from our satisfied clients. Check back soon to read about
                                their experiences with Tirumakudalu Properties.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
    <hr>

    <!-- Services Section -->
    <section class="services-showcase" id="services">
        <div class="container">
            <div class="section-header">
                <h2>Our Services</h2>
            </div>

            <div class="services-layout">
                <!-- Service 1: Rental of Properties - Blurred Background Style -->
                <div class="service-section service-rental">
                    <div class="service-bg-image" style="background-image: url('/images/img1.webp');"></div>
                    <div class="service-content-overlay">
                        <div class="service-section-content">
                            <div class="service-label">
                                <div class="label-icon"></div>
                                <span>Our Services</span>
                            </div>
                            <h3 class="service-main-title">Rental of Properties</h3>
                            <p class="service-subtitle">Premium Property Solutions</p>

                            <div class="service-cards-row">
                                <div class="service-testimonial-card">
                                    <p class="service-card-text">We offer comprehensive rental services for premium
                                        properties across India, helping property owners find the right tenants and
                                        assisting tenants in finding their perfect space.</p>
                                    <div class="service-card-footer">
                                        <div class="service-card-icon">
                                            <i class="fas fa-home"></i>
                                        </div>
                                        <div class="service-card-info">
                                            <div class="service-card-title">High-end Apartments</div>
                                            <div class="service-card-rating">
                                                <i class="fas fa-star"></i>
                                                <i class="fas fa-star"></i>
                                                <i class="fas fa-star"></i>
                                                <i class="fas fa-star"></i>
                                                <i class="fas fa-star"></i>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="service-testimonial-card">
                                    <p class="service-card-text">We also undertake advertising of rentals on top-rated
                                        property portals to attract potential tenants for existing properties, ensuring
                                        maximum visibility and reach.</p>
                                    <div class="service-card-footer">
                                        <div class="service-card-icon">
                                            <i class="fas fa-building"></i>
                                        </div>
                                        <div class="service-card-info">
                                            <div class="service-card-title">Commercial Spaces</div>
                                            <div class="service-card-rating">
                                                <i class="fas fa-star"></i>
                                                <i class="fas fa-star"></i>
                                                <i class="fas fa-star"></i>
                                                <i class="fas fa-star"></i>
                                                <i class="fas fa-star"></i>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="service-testimonial-card">
                                    <p class="service-card-text">Office Space | Showrooms | Industrial Sheds | Godowns |
                                        Warehouses - we provide rental solutions for all types of commercial and
                                        industrial properties.</p>
                                    <div class="service-card-footer">
                                        <div class="service-card-icon">
                                            <i class="fas fa-warehouse"></i>
                                        </div>
                                        <div class="service-card-info">
                                            <div class="service-card-title">Industrial Properties</div>
                                            <div class="service-card-rating">
                                                <i class="fas fa-star"></i>
                                                <i class="fas fa-star"></i>
                                                <i class="fas fa-star"></i>
                                                <i class="fas fa-star"></i>
                                                <i class="fas fa-star"></i>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Service 2: Investment in Properties - Image Style Design -->
                <div class="service-section service-investment">
                    <div class="service-section-content">
                        <div class="investment-header-layout">
                            <div class="investment-header-left">
                                <div class="service-label-small">
                                    <div class="label-icon-small"></div>
                                    <span>Investments in India</span>
                                </div>
                                <h3 class="investment-main-title">
                                    Investment in Properties in <span class="title-italic">India</span>
                                </h3>
                            </div>
                            <div class="investment-header-right">
                                <p>Our partnership with renowned builders and developers in India allows us to assist
                                    clients in finding the perfect investment property that meets their specific needs.
                                    We thoroughly investigate all properties by verifying facts, checking documents,
                                    conducting site inspections, and taking pictures.</p>
                            </div>
                        </div>

                        <div class="investment-feature-cards-row">
                            <div class="investment-feature-card">
                                <div class="investment-feature-icon">
                                    <i class="fas fa-search"></i>
                                </div>
                                <h4>Verifying Facts</h4>
                                <p>Thorough verification of all property details and information to ensure accuracy and
                                    reliability.</p>
                                <div class="investment-feature-line"></div>
                            </div>

                            <div class="investment-feature-card featured-investment">
                                <div class="investment-feature-icon">
                                    <i class="fas fa-file-alt"></i>
                                </div>
                                <h4>Checking Documents</h4>
                                <p>Complete document verification and validation to ensure all legal requirements are
                                    met.</p>
                                <div class="investment-feature-line"></div>
                            </div>

                            <div class="investment-feature-card">
                                <div class="investment-feature-icon">
                                    <i class="fas fa-building"></i>
                                </div>
                                <h4>Site Inspections</h4>
                                <p>Comprehensive on-site property inspections to assess condition and value accurately.
                                </p>
                                <div class="investment-feature-line"></div>
                            </div>

                            <div class="investment-feature-card">
                                <div class="investment-feature-icon">
                                    <i class="fas fa-camera"></i>
                                </div>
                                <h4>Photography</h4>
                                <p>Professional property photography services to showcase properties in the best light.
                                </p>
                                <div class="investment-feature-line"></div>
                            </div>
                        </div>

                        <div class="investment-properties-section-bottom">
                            <h4>We deal in the sale of properties across India:</h4>
                            <div class="investment-properties-list">
                                <span class="property-tag">High-end Apartments</span>
                                <span class="property-tag">Villas</span>
                                <span class="property-tag">Commercial Spaces</span>
                                <span class="property-tag">Office Space</span>
                                <span class="property-tag">Showrooms</span>
                                <span class="property-tag">Industrial Sheds</span>
                                <span class="property-tag">Godowns</span>
                                <span class="property-tag">Warehouses</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Service 3: Property Management - Grid with Background Numbers -->
                <div class="service-section service-management">
                    <div class="service-abstract-bg"></div>
                    <div class="service-section-content">
                        <div class="service-header-key" style="margin-left: 350px;">
                            <h3 class="service-header-key-title" style="text-align: center;">
                                Property Management Services.</h3>
                        </div>
                        <p class="service-intro">We undertake comprehensive property management to ensure your property
                            is well-maintained, compliant, and generating optimal returns.</p>
                        <div class="service-features-grid-key">
                            <div class="key-feature-block">
                                <div class="feature-number">01</div>
                                <h4>Thorough Cleaning</h4>
                                <div class="feature-underline-key"></div>
                                <p>Complete cleaning before offering property for rent</p>
                            </div>
                            <div class="key-feature-block">
                                <div class="feature-number">02</div>
                                <h4>Regular Maintenance</h4>
                                <div class="feature-underline-key"></div>
                                <p>Ongoing maintenance and necessary repairs</p>
                            </div>
                            <div class="key-feature-block">
                                <div class="feature-number">03</div>
                                <h4>Tax Management</h4>
                                <div class="feature-underline-key"></div>
                                <p>Timely payment of property taxes</p>
                            </div>
                            <div class="key-feature-block">
                                <div class="feature-number">04</div>
                                <h4>Documentation</h4>
                                <div class="feature-underline-key"></div>
                                <p>Acquiring all necessary documents from government authorities</p>
                            </div>
                            <div class="key-feature-block">
                                <div class="feature-number">05</div>
                                <h4>Regular Inspections</h4>
                                <div class="feature-underline-key"></div>
                                <p>Conducting regular property inspections and providing detailed reports</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Service 5: Value Added Services - Blurred Background Style with Slider -->
                <div class="service-section service-rental service-property service-property-slider">
                    <div class="service-bg-slider">
                        <div class="service-bg-slide" style="background-image: url('/images/img1.webp');"></div>
                        <div class="service-bg-slide" style="background-image: url('/images/img2.webp');"></div>
                        <div class="service-bg-slide" style="background-image: url('/images/img3.webp');"></div>
                        <div class="service-bg-slide" style="background-image: url('/images/img4.webp');"></div>
                        <div class="service-bg-slide" style="background-image: url('/images/img5.webp');"></div>
                    </div>
                    <div class="service-content-overlay">
                        <div class="service-section-content">
                            <div class="service-label">
                                <div class="label-icon"></div>
                                <span>Our Services</span>
                            </div>
                            <h3 class="service-main-title">Value Added Services</h3>
                            <p class="service-subtitle">Comprehensive Property Solutions</p>

                            <div class="service-cards-row">
                                <div class="service-testimonial-card">
                                    <p class="service-card-text">We provide comprehensive property services including
                                        registration, documentation, and transactions. Our expert team ensures all
                                        property dealings are transparent, secure, and compliant with regulatory
                                        requirements across major cities in Karnataka.</p>
                                    <div class="service-card-footer">
                                        <div class="service-card-icon">
                                            <i class="fas fa-stamp"></i>
                                        </div>
                                        <div class="service-card-info">
                                            <div class="service-card-title">Registration & Documentation</div>
                                            <div class="service-card-rating">
                                                <i class="fas fa-star"></i>
                                                <i class="fas fa-star"></i>
                                                <i class="fas fa-star"></i>
                                                <i class="fas fa-star"></i>
                                                <i class="fas fa-star"></i>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="service-testimonial-card">
                                    <p class="service-card-text">We handle property transactions including buying,
                                        selling, and reselling with complete legal verification and title clearance. Our
                                        services ensure smooth and hassle-free property transactions for all our
                                        clients.</p>
                                    <div class="service-card-footer">
                                        <div class="service-card-icon">
                                            <i class="fas fa-handshake"></i>
                                        </div>
                                        <div class="service-card-info">
                                            <div class="service-card-title">Property Transactions</div>
                                            <div class="service-card-rating">
                                                <i class="fas fa-star"></i>
                                                <i class="fas fa-star"></i>
                                                <i class="fas fa-star"></i>
                                                <i class="fas fa-star"></i>
                                                <i class="fas fa-star"></i>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="service-testimonial-card">
                                    <p class="service-card-text">We offer property verification, due diligence,
                                        inspection, and valuation services. Our team provides market analysis and
                                        pricing to help you make informed decisions about your property investments.</p>
                                    <div class="service-card-footer">
                                        <div class="service-card-icon">
                                            <i class="fas fa-search"></i>
                                        </div>
                                        <div class="service-card-info">
                                            <div class="service-card-title">Verification & Valuation</div>
                                            <div class="service-card-rating">
                                                <i class="fas fa-star"></i>
                                                <i class="fas fa-star"></i>
                                                <i class="fas fa-star"></i>
                                                <i class="fas fa-star"></i>
                                                <i class="fas fa-star"></i>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
    <hr>

    <!-- Team Highlights Section -->
    <section class="about-team-compact">
        <div class="container">
            <h3 class="about-team-title">Our Expertise</h3>
            <div class="team-compact-grid">
                <div class="team-compact-item">
                    <i class="fas fa-chart-line"></i>
                    <p>Thorough understanding of the Indian Regional real estate market</p>
                </div>
                <div class="team-compact-item">
                    <i class="fas fa-star"></i>
                    <p>Attention to detail and excellent customer service</p>
                </div>
                <div class="team-compact-item">
                    <i class="fas fa-cog"></i>
                    <p>Expertise to make property transactions smooth and Hassle-free</p>
                </div>
                <div class="team-compact-item">
                    <i class="fas fa-trophy"></i>
                    <p>Dedicated to delivering the highest quality of Service</p>
                </div>
            </div>
        </div>
    </section>
    <hr>

    <!-- Founder Info Section -->
    <section class="about-founder-compact">
        <div class="container">
            <div class="founder-compact-content">
                <div class="founder-compact-image">
                    <img src="/images/Seshadri_TS_full.webp" alt="Seshadri T S" loading="lazy">
                </div>
                <div class="founder-compact-info">
                    <div class="founder-compact-label">About Founder</div>
                    <h3 style="color: #8B2E3D;">Seshadri T S.</h3>
                    <div class="founder-compact-role">Proprietor | Consultant</div>
                    <p>Tirumakudalu Properties is a solely owned and operated firm promoted by Mr. Seshadri T. S. He has
                        over 30 years of vast professional experience in finance, marketing, and sales, and 16 years in
                        the field of property management. Mr. Seshadri is the grandson of Sri T. Rama Rao, the late
                        founder member of The National Institute of Engineering (NIE), Mysore.</p>
                </div>
            </div>
        </div>
    </section>
    <hr>

    <!-- Statistics -->
    <section class="statistics">
        <div class="container">
            <div class="stats-grid">
                <div class="stat-card" data-stat="properties_listed">
                    <div class="stat-icon"><i class="fas fa-building"></i></div>
                    <div class="stat-number" data-target="0">0</div>
                    <div class="stat-label">Properties Listed</div>
                </div>
                <div class="stat-card" data-stat="happy_clients">
                    <div class="stat-icon"><i class="fas fa-users"></i></div>
                    <div class="stat-number" data-target="45">45</div>
                    <div class="stat-label">Happy Clients</div>
                </div>
                <div class="stat-card" data-stat="years_experience">
                    <div class="stat-icon"><i class="fas fa-award"></i></div>
                    <div class="stat-number" data-target="16">16</div>
                    <div class="stat-label">Years Experience</div>
                </div>
                <div class="stat-card" data-stat="deals_closed">
                    <div class="stat-icon"><i class="fas fa-handshake"></i></div>
                    <div class="stat-number" data-target="20">20</div>
                    <div class="stat-label">Deals Closed</div>
                </div>
            </div>
        </div>
    </section>
    <hr>

    <!-- Contact Section -->
    <section class="contact" id="contact">
        <div class="container">
            <div class="section-header">
                <h2>Get In Touch</h2>
            </div>
            <div class="contact-content">
                <div class="contact-info">
                    <div class="contact-item">
                        <div class="contact-icon">
                            <i class="fas fa-map-marker-alt"></i>
                        </div>
                        <div>
                            <h4>Address</h4>
                            <p>78, SBM COLONY, 2ND CROSS, KONANAKUNTE<br>BANGALORE - 560062</p>
                        </div>
                    </div>
                    <div class="contact-item">
                        <div class="contact-icon">
                            <i class="fas fa-phone"></i>
                        </div>
                        <div>
                            <h4>Phone</h4>
                            <p>+91 97411 11756</p>
                        </div>
                    </div>
                    <div class="contact-item">
                        <div class="contact-icon">
                            <i class="fas fa-envelope"></i>
                        </div>
                        <div>
                            <h4>Email</h4>
                            <p>info@tirumakudaluproperties.com</p>
                        </div>
                    </div>
                </div>
                <form class="contact-form" id="contactForm">
                    <div class="form-row">
                        <div class="form-group">
                            <input type="text" id="contactName" name="name" placeholder="Your Name" required>
                        </div>
                        <div class="form-group">
                            <input type="email" id="contactEmail" name="email" placeholder="Your Email" required>
                        </div>
                    </div>
                    <div class="form-group">
                        <input type="text" id="contactSubject" name="subject" placeholder="Subject" required>
                    </div>
                    <div class="form-group">
                        <textarea id="contactMessage" name="message" placeholder="Your Message" rows="5"
                            required></textarea>
                    </div>
                    <div class="form-group">
                        <input type="tel" id="contactPhone" name="phone" placeholder="Phone Number (Optional)">
                    </div>
                    <div class="form-message" id="contactFormMessage" style="display: none;"></div>
                    <button type="submit" class="btn btn-primary" id="contactSubmitBtn">
                        <span class="btn-text">Send Message</span>
                        <span class="btn-loader" style="display: none;">
                            <i class="fas fa-spinner fa-spin"></i> Sending...
                        </span>
                    </button>
                </form>
            </div>
        </div>
    </section>
    <hr>

    <!-- Login Modal -->
    <div class="login-modal" id="loginModal">
        <div class="login-modal-overlay" id="loginModalOverlay"></div>
        <div class="login-modal-content">
            <button class="login-modal-close" id="loginModalClose">
                <i class="fas fa-times"></i>
            </button>
            <div class="login-modal-header">
                <div class="login-modal-icon">
                    <i class="fas fa-user-circle"></i>
                </div>
                <h2>Welcome Back</h2>
                <p>Sign in to your account to continue</p>
            </div>
            <form class="login-form" id="loginForm">
                <div class="form-group">
                    <label for="loginEmail">
                        <i class="fas fa-envelope"></i>
                        Email Address
                    </label>
                    <input type="email" id="loginEmail" name="email" placeholder="Enter your email" required>
                </div>
                <div class="form-group">
                    <label for="loginPassword">
                        <i class="fas fa-lock"></i>
                        Password
                    </label>
                    <div class="password-input-wrapper">
                        <input type="password" id="loginPassword" name="password" placeholder="Enter your password"
                            required>
                        <button type="button" class="password-toggle" id="passwordToggle">
                            <i class="fas fa-eye"></i>
                        </button>
                    </div>
                </div>
                <div class="login-form-options">
                    <label class="remember-me">
                        <input type="checkbox" id="rememberMe" name="rememberMe">
                        <span>Remember Me</span>
                    </label>
                </div>
                <button type="submit" class="btn-login-submit">
                    <span>Sign In</span>
                    <i class="fas fa-arrow-right"></i>
                </button>
            </form>
        </div>
    </div>

    <!-- Frequently Asked Questions Section -->
    <section class="about-faq-compact">
        <div class="faq-background-overlay"></div>
        <div class="container">
            <div class="faq-section-header">
                <div class="faq-header-icon">
                    <i class="fas fa-question-circle"></i>
                </div>
                <h3 class="faq-compact-title">Frequently Asked Questions</h3>
                <p class="faq-compact-subtitle">Find answers to common questions about our services and expertise</p>
            </div>
            <div class="faq-compact-grid">
                <div class="faq-compact-item">
                    <div class="faq-item-icon-wrapper">
                        <i class="fas fa-question-circle"></i>
                    </div>
                    <h4>What services do you offer?</h4>
                    <p>We offer property valuation, listing, marketing, legal services, property management, buying and
                        selling real estate, building services, interior decoration, security, CCTV services, and more.
                    </p>
                    <div class="faq-item-decoration"></div>
                </div>
                <div class="faq-compact-item">
                    <div class="faq-item-icon-wrapper">
                        <i class="fas fa-question-circle"></i>
                    </div>
                    <h4>Do you provide government-related services?</h4>
                    <p>Yes, we work with government agencies to provide land records, possession certificates, khata,
                        tax certificates, loans, and other related services.</p>
                    <div class="faq-item-decoration"></div>
                </div>
                <div class="faq-compact-item">
                    <div class="faq-item-icon-wrapper">
                        <i class="fas fa-question-circle"></i>
                    </div>
                    <h4>How can you help with my real estate needs?</h4>
                    <p>Whether you're looking to buy, sell, or manage a property, our experienced team provides a
                        hassle-free experience ensuring smooth and stress-free transactions.</p>
                    <div class="faq-item-decoration"></div>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-col">
                    <div class="footer-logo">
                        <a href="#home" class="logo-link">
                            <div class="logo-graphic">
                                <img src="/images/TS_Logo_White .png" alt="Tirumakudalu Properties Logo" width="300px"
                                    height="auto" style="margin-left: 150px;" loading="lazy">
                            </div>
                        </a>
                    </div>
                    <p>Tirumakudalu Properties offers Property Management & Real Estate Services in and around Bangalore
                        City.</p>
                </div>
                <div class="footer-col">
                    <h4>Quick Links</h4>
                    <ul class="footer-links">
                        <li><a href="/blogs.html">Blogs</a></li>
                        <li><a href="#">Terms and Conditions</a></li>
                        <li><a href="#">Privacy Policy</a></li>
                        <li><a href="#">NRI Property Investment</a></li>
                    </ul>
                </div>
                <div class="footer-col">
                    <h4>Contact Information</h4>
                    <ul class="footer-contact">
                        <li>
                            <i class="fas fa-phone"></i>
                            <span>+91 97411 11756/+91 96861 31414</span>
                        </li>
                        <li>
                            <i class="fas fa-envelope"></i>
                            <span>info@tirumakudaluproperties.com</span>
                        </li>
                        <li>
                            <i class="fas fa-map-marker-alt"></i>
                            <span>#76, 2ND floor, 2ND CROSS, Mysore Bank Colony, JP nagar, 7th Phase, BANGALORE -
                                560078</span>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="footer-bottom">
                <p>Copyright &copy; 2025 - Designed & Powered by <a href="https://purplehuetechnosoft.com/"
                        target="_blank" rel="noopener noreferrer" class="footer-credit">Purple Hue Technosoft Pvt.
                        Ltd.</a></p>
            </div>
        </div>
    </footer>

    <!-- Floating Button to Browse by Property Type -->
    <button class="floating-property-type-btn" id="floatingPropertyTypeBtn" title="Browse by Property Type">
        <i class="fas fa-building"></i>
        <span class="floating-btn-text">Browse by Property Type</span>
    </button>

    <!-- Critical JS - Load immediately -->
    <script src="/js/session-manager.js" defer></script>
    <script src="/js/login.js" defer></script>
    <!-- Non-critical JS - Load after page is interactive -->
    <script>
        // Load non-critical scripts after page load
        window.addEventListener('load', function () {
            const scripts = [
                '/js/script.js',
                '/js/properties.js',
                '/js/page-tracking.js',
                '/js/app-metrics-tracker.js'
            ];
            scripts.forEach(function (src) {
                const script = document.createElement('script');
                script.src = src;
                script.defer = true;
                if (src.includes('page-tracking') || src.includes('app-metrics')) {
                    script.async = true;
                }
                document.body.appendChild(script);
            });
        });
    </script>
    <script>
        // Partners data and rendering for compact section
        (function () {
            let partners = [];

            // Load partners from API
            async function loadPartnersFromAPI() {
                try {
                    // Fetch active partners (sorted by display_order)
                    let fetchedPartners = [];

                    try {
                        const response = await fetch('/api/partners?is_active=true', {
                            headers: {
                                'Accept': 'application/json',
                                'Content-Type': 'application/json'
                            }
                        });

                        if (response.ok) {
                            try {
                                const data = await response.json();
                                // Validate response is an array
                                if (Array.isArray(data)) {
                                    fetchedPartners = data;
                                } else {
                                    console.warn('Partners API returned non-array response');
                                }
                            } catch (parseError) {
                                console.warn('Error parsing partners response:', parseError);
                            }
                        } else {
                            // Log error but don't throw
                            let errorMessage = `HTTP ${response.status}: ${response.statusText}`;
                            try {
                                const errorData = await response.json();
                                errorMessage = errorData.detail || errorData.error || errorMessage;
                            } catch (e) {
                                // Ignore JSON parse errors
                            }
                            console.warn('Failed to fetch partners:', errorMessage);
                        }
                    } catch (fetchError) {
                        // Handle network errors, CORS errors, or other fetch failures
                        if (fetchError.name === 'TypeError' && fetchError.message.includes('fetch')) {
                            console.warn('Network error fetching partners:', fetchError.message);
                        } else {
                            console.warn('Error fetching partners:', fetchError);
                        }
                    }

                    // Convert API format to display format with validation
                    partners = fetchedPartners
                        .filter(p => p && p.name) // Only include partners with names
                        .map(partner => ({
                            id: partner.id || 0,
                            name: partner.name || 'Partner',
                            logo_url: partner.logo_url || null,
                            website_url: partner.website_url || '#',
                            description: partner.description || '',
                            display_order: partner.display_order || 0
                        }));

                    // Sort by display_order (already sorted by API, but ensure it)
                    partners.sort((a, b) => (a.display_order || 0) - (b.display_order || 0));

                    renderPartnersCompact();
                } catch (error) {
                    // Silently handle any unexpected errors - don't break the page
                    console.warn('Unexpected error loading partners from API:', error);
                    // Keep empty state if API fails
                    partners = [];
                    renderPartnersCompact();
                }
            }

            const partnersPerRow = 6; // Approximate number of cards per row (adjust based on your grid)
            const initialRows = 2;
            const initialPartnersCount = partnersPerRow * initialRows;
            let isExpanded = false;

            function renderPartnersCompact() {
                const grid = document.getElementById('partnersCompactGrid');
                const loadMoreContainer = document.getElementById('partnersLoadMoreContainer');
                const loadMoreBtn = document.getElementById('loadMorePartnersBtn');
                const showLessContainer = document.getElementById('partnersShowLessContainer');
                const showLessBtn = document.getElementById('showLessPartnersBtn');
                if (!grid) return;

                if (partners.length === 0) {
                    // Show empty state (already in HTML or can add one)
                    if (loadMoreContainer) loadMoreContainer.style.display = 'none';
                    if (showLessContainer) showLessContainer.style.display = 'none';
                    return;
                }

                // Partners that need black background and white text (can be configured in dashboard)
                // For now, we'll use a simple check based on logo or name
                const blackBackgroundPartners = [];

                // Render all partners - all cards are visible in DOM
                grid.innerHTML = partners.map((partner, index) => {
                    const hasBlackBackground = blackBackgroundPartners.includes(partner.name);
                    const cardClass = hasBlackBackground ? 'partner-compact-card partner-compact-card-dark' : 'partner-compact-card';
                    const websiteUrl = partner.website_url && partner.website_url !== '#'
                        ? partner.website_url
                        : '#';
                    const targetAttr = websiteUrl !== '#' ? 'target="_blank" rel="noopener noreferrer"' : '';

                    return `
                        <a href="${escapeHtml(websiteUrl)}" class="${cardClass}" ${targetAttr} data-partner-index="${index}">
                            ${partner.logo_url ? `
                            <div class="partner-compact-logo">
                                <img src="${escapeHtml(partner.logo_url)}" 
                                     alt="${escapeHtml(partner.name)} Logo" 
                                     class="partner-logo-img"
                                     loading="lazy"
                                     onerror="this.style.display='none'; const fallback = this.parentElement?.querySelector('.partner-compact-info'); if (fallback && fallback.style) fallback.style.display='flex';">
                            </div>` : ''}
                            <div class="partner-compact-info" ${partner.logo_url ? '' : 'style="display: flex; width: 100%;"'}>
                                <h4 class="partner-compact-name">${escapeHtml(partner.name)}</h4>
                            </div>
                        </a>
                    `;
                }).join('');

                // Set initial state - collapsed (showing only 2 rows)
                isExpanded = false;
                grid.classList.remove('partners-grid-expanded');
                grid.classList.add('partners-grid-collapsed');

                // Show/hide load more and show less buttons
                if (loadMoreContainer && loadMoreBtn && showLessContainer && showLessBtn) {
                    if (partners.length > initialPartnersCount) {
                        // Initially show Load More button
                        loadMoreContainer.style.display = 'flex';
                        showLessContainer.style.display = 'none';

                        // Load More button click handler
                        loadMoreBtn.onclick = function (e) {
                            e.preventDefault();
                            e.stopPropagation();

                            // Expand to show all cards
                            if (!isExpanded) {
                                grid.classList.remove('partners-grid-collapsed');
                                grid.classList.add('partners-grid-expanded');
                                isExpanded = true;
                                loadMoreContainer.style.display = 'none';
                                showLessContainer.style.display = 'flex';
                            }
                        };

                        // Show Less button click handler
                        showLessBtn.onclick = function (e) {
                            e.preventDefault();
                            e.stopPropagation();

                            // Collapse to show only initial cards
                            if (isExpanded) {
                                grid.classList.remove('partners-grid-expanded');
                                grid.classList.add('partners-grid-collapsed');
                                isExpanded = false;
                                showLessContainer.style.display = 'none';
                                loadMoreContainer.style.display = 'flex';

                                // Scroll to partners section smoothly
                                const partnersSection = document.getElementById('partners');
                                if (partnersSection) {
                                    partnersSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
                                }
                            }
                        };
                    } else {
                        loadMoreContainer.style.display = 'none';
                        showLessContainer.style.display = 'none';
                    }
                }
            }

            // Helper function to escape HTML
            function escapeHtml(text) {
                const div = document.createElement('div');
                div.textContent = text;
                return div.innerHTML;
            }

            if (document.readyState === 'loading') {
                document.addEventListener('DOMContentLoaded', () => {
                    loadPartnersFromAPI();
                });
            } else {
                loadPartnersFromAPI();
            }
        })();

        // Testimonials rendering for compact section
        (function () {
            let testimonials = [];

            function generateStars(rating) {
                let stars = '';
                for (let i = 1; i <= 5; i++) {
                    if (i <= rating) {
                        stars += '<i class="fas fa-star"></i>';
                    } else {
                        stars += '<i class="far fa-star"></i>';
                    }
                }
                return stars;
            }

            // JSONP helper function
            function loadTestimonialsJSONP(url, callback) {
                return new Promise((resolve, reject) => {
                    // Generate a valid callback name that matches backend regex: ^[a-zA-Z_$][a-zA-Z0-9_$]*$
                    const callbackName = 'testimonialsCallback' + Date.now() + Math.random().toString(36).substr(2, 9);
                    const script = document.createElement('script');
                    const timeout = setTimeout(() => {
                        cleanup();
                        reject(new Error('JSONP request timeout'));
                    }, 10000); // 10 second timeout

                    window[callbackName] = function (data) {
                        clearTimeout(timeout);
                        cleanup();
                        resolve(data);
                    };

                    function cleanup() {
                        if (script.parentNode) {
                            script.parentNode.removeChild(script);
                        }
                        delete window[callbackName];
                    }

                    script.src = url + (url.indexOf('?') >= 0 ? '&' : '?') + 'callback=' + callbackName;
                    script.onerror = function () {
                        clearTimeout(timeout);
                        cleanup();
                        reject(new Error('JSONP script load failed'));
                    };

                    document.head.appendChild(script);
                });
            }

            // Load testimonials from API using JSONP (preferred) with fetch fallback
            async function loadTestimonialsFromAPI() {
                try {
                    let fetchedTestimonials = [];
                    let useJSONP = true; // Prefer JSONP for cross-origin compatibility

                    // Try to fetch featured testimonials first
                    try {
                        if (useJSONP) {
                            try {
                                const url = '/api/testimonials?is_approved=true&is_featured=true';
                                console.log('Loading featured testimonials via JSONP:', url);
                                const data = await loadTestimonialsJSONP(url);
                                if (Array.isArray(data)) {
                                    fetchedTestimonials = data;
                                    console.log('Featured testimonials loaded:', fetchedTestimonials.length);
                                }
                            } catch (jsonpError) {
                                console.warn('JSONP failed, falling back to fetch:', jsonpError);
                                useJSONP = false; // Fall back to fetch
                            }
                        }

                        // Fallback to fetch if JSONP failed or not preferred
                        if (!useJSONP || fetchedTestimonials.length === 0) {
                            const featuredUrl = '/api/testimonials?is_approved=true&is_featured=true';
                            console.log('Loading featured testimonials via fetch:', featuredUrl);
                            const response = await fetch(featuredUrl, {
                                headers: {
                                    'Accept': 'application/json',
                                    'Content-Type': 'application/json'
                                }
                            });

                            if (response.ok) {
                                try {
                                    const data = await response.json();
                                    if (Array.isArray(data)) {
                                        fetchedTestimonials = data;
                                        console.log('Featured testimonials loaded via fetch:', fetchedTestimonials.length);
                                    } else {
                                        console.warn('Featured testimonials API returned non-array:', data);
                                    }
                                } catch (parseError) {
                                    console.error('Error parsing featured testimonials response:', parseError);
                                }
                            } else {
                                let errorMessage = `HTTP ${response.status}: ${response.statusText}`;
                                try {
                                    const errorData = await response.json();
                                    errorMessage = errorData.detail || errorData.error || errorMessage;
                                } catch (e) {
                                    // Ignore JSON parse errors
                                }
                                console.warn('Failed to fetch featured testimonials:', errorMessage);
                            }
                        }
                    } catch (fetchError) {
                        console.error('Error fetching featured testimonials:', fetchError);
                    }

                    // If no featured testimonials, get all approved
                    if (fetchedTestimonials.length === 0) {
                        try {
                            if (useJSONP) {
                                try {
                                    const url = '/api/testimonials?is_approved=true';
                                    console.log('Loading all approved testimonials via JSONP:', url);
                                    const data = await loadTestimonialsJSONP(url);
                                    if (Array.isArray(data)) {
                                        fetchedTestimonials = data;
                                        console.log('All testimonials loaded:', fetchedTestimonials.length);
                                    }
                                } catch (jsonpError) {
                                    console.warn('JSONP failed for all testimonials, falling back to fetch:', jsonpError);
                                    useJSONP = false;
                                }
                            }

                            if (!useJSONP || fetchedTestimonials.length === 0) {
                                const allUrl = '/api/testimonials?is_approved=true';
                                console.log('Loading all approved testimonials via fetch:', allUrl);
                                const allResponse = await fetch(allUrl, {
                                    headers: {
                                        'Accept': 'application/json',
                                        'Content-Type': 'application/json'
                                    }
                                });

                                if (allResponse.ok) {
                                    try {
                                        const allTestimonials = await allResponse.json();
                                        if (Array.isArray(allTestimonials)) {
                                            fetchedTestimonials = allTestimonials;
                                            console.log('All testimonials loaded via fetch:', fetchedTestimonials.length);
                                        } else {
                                            console.warn('All testimonials API returned non-array:', allTestimonials);
                                        }
                                    } catch (parseError) {
                                        console.error('Error parsing all testimonials response:', parseError);
                                    }
                                } else {
                                    let errorMessage = `HTTP ${allResponse.status}: ${allResponse.statusText}`;
                                    try {
                                        const errorData = await allResponse.json();
                                        errorMessage = errorData.detail || errorData.error || errorMessage;
                                    } catch (e) {
                                        // Ignore JSON parse errors
                                    }
                                    console.error('Failed to fetch all testimonials:', errorMessage);
                                }
                            }
                        } catch (fallbackError) {
                            console.error('Error fetching all testimonials:', fallbackError);
                        }
                    }

                    // Convert API format to display format with validation
                    testimonials = fetchedTestimonials
                        .filter(t => t && t.message) // Only include testimonials with messages
                        .map(testimonial => ({
                            id: testimonial.id || 0,
                            name: testimonial.client_name || 'Anonymous',
                            serviceType: testimonial.service_type || 'General',
                            rating: testimonial.rating || 5,
                            message: testimonial.message || '',
                            date: testimonial.created_at ? new Date(testimonial.created_at).toLocaleDateString() : ''
                        }));

                    console.log('Final testimonials count:', testimonials.length);
                    renderTestimonialsCompact();
                } catch (error) {
                    console.error('Unexpected error loading testimonials:', error);
                    testimonials = [];
                    renderTestimonialsCompact();
                }
            }

            function renderTestimonialsCompact() {
                const grid = document.getElementById('testimonialsCompactGrid');
                if (!grid) {
                    return;
                }

                if (testimonials.length === 0) {
                    // Show empty state (already in HTML)
                    grid.classList.remove('scrolling');
                    // Make sure empty state is visible
                    const emptyState = grid.querySelector('.testimonials-compact-empty');
                    if (emptyState) {
                        emptyState.style.display = 'block';
                    }
                    return;
                }

                // Hide empty state and add scrolling class
                grid.classList.add('scrolling');
                const emptyState = grid.querySelector('.testimonials-compact-empty');
                if (emptyState) {
                    emptyState.style.display = 'none';
                }

                // Render testimonials twice for seamless infinite scrolling
                const displayTestimonials = testimonials;
                const testimonialCards = displayTestimonials.map(testimonial => `
                    <div class="testimonial-compact-card">
                        <div class="testimonial-compact-header">
                            <div class="testimonial-compact-avatar">
                                <i class="fas fa-user"></i>
                            </div>
                            <div class="testimonial-compact-info">
                                <h4 class="testimonial-compact-name">${escapeHtml(testimonial.name)}</h4>
                                <div class="testimonial-compact-meta">
                                    <span class="testimonial-compact-service">${escapeHtml(testimonial.serviceType)}</span>
                                </div>
                            </div>
                        </div>
                        <div class="testimonial-compact-rating">
                            ${generateStars(testimonial.rating)}
                        </div>
                        <div class="testimonial-compact-content">
                            <p>"${escapeHtml(testimonial.message)}"</p>
                        </div>
                    </div>
                `).join('');

                // Duplicate cards for seamless infinite scroll
                grid.innerHTML = testimonialCards + testimonialCards;
            }

            // Helper function to escape HTML
            function escapeHtml(text) {
                const div = document.createElement('div');
                div.textContent = text;
                return div.innerHTML;
            }

            if (document.readyState === 'loading') {
                document.addEventListener('DOMContentLoaded', () => {
                    loadTestimonialsFromAPI();
                });
            } else {
                loadTestimonialsFromAPI();
            }
        })();

        // Floating Button to Browse by Property Type
        (function () {
            const floatingBtn = document.getElementById('floatingPropertyTypeBtn');
            const propertyTypesSection = document.querySelector('.property-types');

            if (!floatingBtn) {
                console.error('Floating button not found');
                return;
            }

            if (!propertyTypesSection) {
                console.error('Property types section not found');
                return;
            }

            function checkScrollPosition() {
                // Get section position relative to viewport
                const rect = propertyTypesSection.getBoundingClientRect();
                const sectionTop = rect.top;
                const sectionBottom = rect.bottom;

                // Add buffer (200px) to make detection more forgiving
                const buffer = 200;

                // Check if section is visible in viewport (with buffer)
                // Section is considered visible if any part of it is within the viewport + buffer
                const isSectionInView = sectionBottom > -buffer && sectionTop < (window.innerHeight + buffer);

                // Hide button if section IS in view, show it otherwise
                if (isSectionInView) {
                    floatingBtn.classList.add('hidden');
                } else {
                    floatingBtn.classList.remove('hidden');
                }
            }

            // Handle button click - scroll to property types section
            floatingBtn.addEventListener('click', () => {
                propertyTypesSection.scrollIntoView({
                    behavior: 'smooth',
                    block: 'start'
                });
            });

            // Throttle function to limit how often checkScrollPosition runs
            let scrollTimeout = null;
            let resizeTimeout = null;

            function throttledCheckScrollPosition() {
                if (scrollTimeout) return;
                scrollTimeout = requestAnimationFrame(() => {
                    checkScrollPosition();
                    scrollTimeout = null;
                });
            }

            function throttledCheckResize() {
                if (resizeTimeout) {
                    cancelAnimationFrame(resizeTimeout);
                }
                resizeTimeout = requestAnimationFrame(() => {
                    checkScrollPosition();
                    resizeTimeout = null;
                });
            }

            // Check scroll position on scroll and on load (throttled)
            window.addEventListener('scroll', throttledCheckScrollPosition, { passive: true });
            window.addEventListener('resize', throttledCheckResize, { passive: true });

            // Initial check - wait for page to fully load
            function initButton() {
                setTimeout(() => {
                    checkScrollPosition();
                }, 300);
            }

            if (document.readyState === 'loading') {
                document.addEventListener('DOMContentLoaded', initButton);
            } else {
                initButton();
            }

            // Also check after window fully loads (images, etc.)
            window.addEventListener('load', () => {
                setTimeout(checkScrollPosition, 100);
            });
        })();
    </script>
    <script>
        // Index Page Filters - Inline JavaScript (isolated namespace)
        (function () {
            'use strict';

            // Filter state variables for index page
            let indexCurrentFilter = 'all';
            let indexSelectedCondition = null;
            let indexSelectedBHK = null;
            let indexSelectedPropertyType = null;
            let indexSelectedCategory = null;

            // Load unit types and populate dropdown
            async function loadUnitTypes() {
                try {
                    // Add cache-busting timestamp to ensure fresh data
                    const timestamp = new Date().getTime();
                    const response = await fetch(`/api/unit-types?_t=${timestamp}`, {
                        method: 'GET',
                        cache: 'no-cache',
                        headers: {
                            'Cache-Control': 'no-cache'
                        }
                    });

                    if (response.ok) {
                        const data = await response.json();
                        console.log('Unit Types API response:', data);
                        const unitTypeSelect = document.getElementById('indexSearchUnitType');
                        if (!unitTypeSelect) {
                            console.error('Unit Type select element not found: indexSearchUnitType');
                            return;
                        }
                        if (data.unit_types && Array.isArray(data.unit_types)) {
                            // Store current selection before clearing
                            const currentValue = unitTypeSelect.value;

                            // Clear existing options except the first "Any Unit Type" option
                            unitTypeSelect.innerHTML = '<option value="">Any Unit Type</option>';

                            // If no unit types, show message
                            if (data.unit_types.length === 0) {
                                const option = document.createElement('option');
                                option.value = '';
                                option.textContent = 'No unit types available';
                                option.disabled = true;
                                unitTypeSelect.appendChild(option);
                                return;
                            }

                            // Add unit types sorted by bedrooms, then name
                            data.unit_types.forEach(unitType => {
                                if (unitType && unitType.name && unitType.display_name) {
                                    const option = document.createElement('option');
                                    option.value = unitType.name;
                                    option.textContent = unitType.display_name;
                                    // Preserve data-bhk attribute for compatibility with existing code
                                    if (unitType.bedrooms !== null && unitType.bedrooms !== undefined) {
                                        option.setAttribute('data-bhk', unitType.bedrooms.toString());
                                    }
                                    unitTypeSelect.appendChild(option);
                                }
                            });

                            // Restore selected value from URL params if present, otherwise restore previous selection
                            const urlParams = new URLSearchParams(window.location.search);
                            const unitTypeParam = urlParams.get('unit_type') || urlParams.get('type');
                            if (unitTypeParam && unitTypeSelect.querySelector(`option[value="${unitTypeParam}"]`)) {
                                unitTypeSelect.value = unitTypeParam;
                            } else if (currentValue && unitTypeSelect.querySelector(`option[value="${currentValue}"]`)) {
                                unitTypeSelect.value = currentValue;
                            }
                        }
                    } else {
                        console.error('Failed to load unit types:', response.status, response.statusText);
                        const unitTypeSelect = document.getElementById('indexSearchUnitType');
                        if (unitTypeSelect) {
                            const option = document.createElement('option');
                            option.value = '';
                            option.textContent = 'Error loading unit types';
                            option.disabled = true;
                            unitTypeSelect.appendChild(option);
                        }
                    }
                } catch (error) {
                    console.error('Error loading unit types:', error);
                    const unitTypeSelect = document.getElementById('indexSearchUnitType');
                    if (unitTypeSelect) {
                        const option = document.createElement('option');
                        option.value = '';
                        option.textContent = 'Error loading unit types';
                        option.disabled = true;
                        unitTypeSelect.appendChild(option);
                    }
                }
            }

            // Load amenities and populate datalist
            async function loadAmenities() {
                try {
                    // Add cache-busting timestamp to ensure fresh data
                    const timestamp = new Date().getTime();
                    const response = await fetch(`/api/amenities?_t=${timestamp}`, {
                        method: 'GET',
                        cache: 'no-cache',
                        headers: {
                            'Cache-Control': 'no-cache'
                        }
                    });

                    if (response.ok) {
                        const data = await response.json();
                        console.log('Amenities API response:', data);
                        const amenitiesSelect = document.getElementById('indexSearchAmenities');
                        if (!amenitiesSelect) {
                            console.error('Amenities select element not found: indexSearchAmenities');
                            return;
                        }
                        if (data.amenities && Array.isArray(data.amenities)) {
                            // Store current value before clearing
                            const currentValue = amenitiesSelect.value;

                            // Clear existing options except the first "Any Amenity" option
                            amenitiesSelect.innerHTML = '<option value="">Any Amenity</option>';

                            // Remove duplicates and sort amenities
                            const uniqueAmenities = [...new Set(data.amenities.map(a => a && a.trim()).filter(Boolean))];
                            uniqueAmenities.sort();

                            // Add amenities to select dropdown
                            if (uniqueAmenities.length > 0) {
                                uniqueAmenities.forEach(amenity => {
                                    const option = document.createElement('option');
                                    option.value = amenity;
                                    // Format amenity name for display (replace underscores with spaces, capitalize)
                                    const displayName = amenity
                                        .replace(/_/g, ' ')
                                        .replace(/\b\w/g, l => l.toUpperCase());
                                    option.textContent = displayName;
                                    amenitiesSelect.appendChild(option);
                                });
                            }

                            // Restore selected value from URL params if present, otherwise restore previous selection
                            const urlParams = new URLSearchParams(window.location.search);
                            const amenitiesParam = urlParams.get('amenities');
                            if (amenitiesParam) {
                                amenitiesSelect.value = amenitiesParam;
                            } else if (currentValue) {
                                amenitiesSelect.value = currentValue;
                            }
                        }
                    } else {
                        console.error('Failed to load amenities:', response.status, response.statusText);
                    }
                } catch (error) {
                    console.error('Error loading amenities:', error);
                }
            }

            // Load localities/areas for a selected city in index page
            async function loadLocalitiesForIndexCity(cityName) {
                try {
                    if (!cityName || cityName.trim() === '') {
                        // Clear area datalist if no city is selected
                        const areaInput = document.getElementById('indexSearchArea');
                        const areaDatalist = document.getElementById('indexSearchAreaList');
                        if (areaDatalist) {
                            areaDatalist.innerHTML = '<option value="">Any Area</option>';
                        }
                        if (areaInput) {
                            areaInput.value = '';
                        }
                        return;
                    }

                    // Add cache-busting timestamp to ensure fresh data
                    const timestamp = new Date().getTime();
                    const apiUrl = `/api/localities?city=${encodeURIComponent(cityName)}&_t=${timestamp}`;
                    console.log('Fetching localities from:', apiUrl);
                    const response = await fetch(apiUrl, {
                        method: 'GET',
                        cache: 'no-cache',
                        headers: {
                            'Cache-Control': 'no-cache'
                        }
                    });

                    if (response.ok) {
                        const data = await response.json();
                        console.log('Localities API response for city "' + cityName + '":', data);
                        console.log('Number of localities received:', data.localities ? data.localities.length : 0);
                        console.log('Response structure:', {
                            hasLocalities: !!data.localities,
                            isArray: Array.isArray(data.localities),
                            localities: data.localities
                        });
                        const areaInput = document.getElementById('indexSearchArea');
                        const areaDatalist = document.getElementById('indexSearchAreaList');
                        if (!areaInput || !areaDatalist) {
                            console.error('Area input or datalist element not found: indexSearchArea');
                            return;
                        }

                        // Store current value before clearing
                        const currentValue = areaInput.value;

                        // Clear existing options but keep "Any Area" option
                        areaDatalist.innerHTML = '<option value="">Any Area</option>';

                        if (data.localities && Array.isArray(data.localities)) {
                            console.log('Processing localities array:', data.localities);
                            // If no localities found, show message
                            if (data.localities.length === 0) {
                                console.warn('No localities found for city:', cityName);
                                const option = document.createElement('option');
                                option.value = '';
                                option.textContent = 'No areas available for this city';
                                areaDatalist.appendChild(option);
                                return;
                            }

                            // Sort localities alphabetically
                            const sortedLocalities = [...data.localities].sort();
                            console.log('Sorted localities:', sortedLocalities);

                            // Add localities to datalist
                            let addedCount = 0;
                            sortedLocalities.forEach(locality => {
                                if (locality && locality.trim()) {
                                    const option = document.createElement('option');
                                    option.value = locality.trim();
                                    option.textContent = locality.trim();
                                    areaDatalist.appendChild(option);
                                    addedCount++;
                                }
                            });
                            console.log(`Added ${addedCount} localities to datalist for city: ${cityName}`);

                            // Restore previous value if it exists
                            if (currentValue) {
                                areaInput.value = currentValue;
                            }
                        } else {
                            console.error('Invalid response structure - data.localities is not an array:', data);
                        }
                    } else {
                        console.error('Failed to load localities:', response.status, response.statusText);
                        const areaDatalist = document.getElementById('indexSearchAreaList');
                        if (areaDatalist) {
                            const option = document.createElement('option');
                            option.value = '';
                            option.textContent = 'Error loading areas';
                            areaDatalist.appendChild(option);
                        }
                    }
                } catch (error) {
                    console.error('Error loading localities:', error);
                    const areaDatalist = document.getElementById('indexSearchAreaList');
                    if (areaDatalist) {
                        const option = document.createElement('option');
                        option.value = '';
                        option.textContent = 'Error loading areas';
                        areaDatalist.appendChild(option);
                    }
                }
            }

            // Load active cities and populate dropdown
            async function loadActiveCities() {
                try {
                    // Add cache-busting timestamp to ensure fresh data
                    const timestamp = new Date().getTime();
                    const response = await fetch(`/api/cities?_t=${timestamp}`, {
                        method: 'GET',
                        cache: 'no-cache',
                        headers: {
                            'Cache-Control': 'no-cache'
                        }
                    });

                    if (response.ok) {
                        const data = await response.json();
                        console.log('Cities API response:', data);
                        const cityInput = document.getElementById('indexSearchCity');
                        const cityDatalist = document.getElementById('indexSearchCityList');
                        if (!cityInput || !cityDatalist) {
                            console.error('City input or datalist element not found: indexSearchCity');
                            return;
                        }
                        if (data.cities && Array.isArray(data.cities)) {
                            // Store current value before clearing
                            const currentValue = cityInput.value;

                            // Clear existing options
                            cityDatalist.innerHTML = '';

                            // If no active cities, show message
                            if (data.cities.length === 0) {
                                const option = document.createElement('option');
                                option.value = '';
                                option.textContent = 'No active cities available';
                                cityDatalist.appendChild(option);
                                return;
                            }

                            // Group cities by state
                            const citiesByState = {};
                            data.cities.forEach(city => {
                                // Handle both string and object formats
                                const cityName = typeof city === 'string' ? city : (city.name || '');
                                const state = typeof city === 'object' ? (city.state || 'Other') : 'Other';

                                if (cityName && cityName.trim()) {
                                    if (!citiesByState[state]) {
                                        citiesByState[state] = [];
                                    }
                                    citiesByState[state].push(cityName.trim());
                                }
                            });

                            // Sort states and cities
                            const sortedStates = Object.keys(citiesByState).sort();
                            sortedStates.forEach(state => {
                                const cities = citiesByState[state].sort();
                                cities.forEach(cityName => {
                                    const option = document.createElement('option');
                                    option.value = cityName;
                                    option.textContent = `${cityName}, ${state}`;
                                    cityDatalist.appendChild(option);
                                });
                            });

                            // Restore selected value from URL params if present, otherwise restore previous selection
                            const urlParams = new URLSearchParams(window.location.search);
                            const cityParam = urlParams.get('city');
                            if (cityParam) {
                                cityInput.value = cityParam;
                                // Load localities for the pre-selected city
                                const cityName = cityParam.includes(',') ? cityParam.split(',')[0].trim() : cityParam.trim();
                                loadLocalitiesForIndexCity(cityName).catch(err => console.error('Error loading localities:', err));
                            } else if (currentValue) {
                                cityInput.value = currentValue;
                                // Load localities for the pre-selected city
                                const cityName = currentValue.includes(',') ? currentValue.split(',')[0].trim() : currentValue.trim();
                                loadLocalitiesForIndexCity(cityName).catch(err => console.error('Error loading localities:', err));
                            }
                        }
                    } else {
                        console.error('Failed to load cities:', response.status, response.statusText);
                        const cityDatalist = document.getElementById('indexSearchCityList');
                        if (cityDatalist) {
                            const option = document.createElement('option');
                            option.value = '';
                            option.textContent = 'Error loading cities';
                            cityDatalist.appendChild(option);
                        }
                    }
                } catch (error) {
                    console.error('Error loading cities:', error);
                    const cityDatalist = document.getElementById('indexSearchCityList');
                    if (cityDatalist) {
                        const option = document.createElement('option');
                        option.value = '';
                        option.textContent = 'Error loading cities';
                        cityDatalist.appendChild(option);
                    }
                }
            }

            // Update filter input visibility by selected subcategory (per dashboard add-property modal)
            function updateIndexFilterGroupsByPropertyType() {
                const container = document.getElementById('indexPropertiesFilters');
                if (!container) return;
                const propertyType = typeof indexSelectedPropertyType === 'string' ? indexSelectedPropertyType : null;
                const residentialTypes = ['apartment', 'house', 'villa'];
                const commercialTypes = ['office-space', 'warehouse', 'showrooms'];
                container.querySelectorAll('.filter-group[data-filter-for]').forEach(el => {
                    const forStr = (el.getAttribute('data-filter-for') || '').trim();
                    const targetTypes = forStr.split(/\s+/);
                    let show = false;

                    // Always show common filters
                    if (targetTypes.includes('common')) {
                        show = true;
                    }
                    // If a property type is selected, check if this filter is applicable to it
                    else if (propertyType) {
                        if (targetTypes.includes(propertyType)) {
                            show = true;
                        }
                    }
                    // If no specific property type is selected, we can check category
                    // For now, if no type matches, we hide the specific filters to keep UI clean
                    // OR we could show them if they apply to major types in the category? 
                    // Let's stick to showing only common unless a type is picked, 
                    // or if the user selected a Category, maybe show fields that are common to ALL types in that category?
                    // But that complicates things. The dashboard logic is type-specific.
                    // Let's just default to hiding specific filters if no type is selected. (Cleanest UI)
                    else {
                        show = false;
                    }

                    el.style.display = show ? '' : 'none';
                });
            }

            // Initialize index filters
            function initIndexFilters() {
                const categorySection = document.getElementById('indexCategorySection');
                if (categorySection) {
                    categorySection.removeAttribute('data-active-category');
                }

                const indexFiltersRoot = document.getElementById('indexPropertiesFilters');
                function updateIndexPropertiesSearchVisibility() {
                    if (!indexFiltersRoot) return;
                    if (indexSelectedPropertyType) {
                        indexFiltersRoot.setAttribute('data-show-search', 'true');
                    } else {
                        indexFiltersRoot.removeAttribute('data-show-search');
                    }
                }



                // City input change handler
                const cityInput = document.getElementById('indexSearchCity');
                if (cityInput) {
                    let cityChangeTimeout;
                    let lastProcessedCity = '';

                    // Function to load localities for a city
                    const loadLocalitiesForCity = async (cityValue) => {
                        if (!cityValue || !cityValue.trim()) {
                            // Clear localities if city is cleared
                            const areaDatalist = document.getElementById('indexSearchAreaList');
                            const areaInput = document.getElementById('indexSearchArea');
                            if (areaDatalist) {
                                areaDatalist.innerHTML = '<option value="">Any Area</option>';
                            }
                            if (areaInput) {
                                areaInput.value = '';
                            }
                            lastProcessedCity = '';
                            indexApplyFilters(false);
                            return;
                        }

                        // Extract city name if it's in format "City, State"
                        const cityName = cityValue.includes(',') ? cityValue.split(',')[0].trim() : cityValue.trim();

                        // Only load if city name changed
                        if (cityName !== lastProcessedCity) {
                            lastProcessedCity = cityName;
                            console.log('Loading localities for city:', cityValue, 'Extracted city name:', cityName);
                            await loadLocalitiesForIndexCity(cityName);
                            indexApplyFilters(false);
                        }
                    };

                    // Handle input event with debounce for typing
                    cityInput.addEventListener('input', () => {
                        if (cityChangeTimeout) {
                            clearTimeout(cityChangeTimeout);
                        }

                        cityChangeTimeout = setTimeout(() => {
                            loadLocalitiesForCity(cityInput.value);
                        }, 300); // 300ms debounce for typing
                    });

                    // Handle blur event - fires when user selects from datalist or clicks away
                    cityInput.addEventListener('blur', () => {
                        // Clear any pending timeout
                        if (cityChangeTimeout) {
                            clearTimeout(cityChangeTimeout);
                            cityChangeTimeout = null;
                        }
                        // Load immediately on blur (when datalist option is selected)
                        loadLocalitiesForCity(cityInput.value);
                    });
                }

                // Amenities select change handler
                const amenitiesSelect = document.getElementById('indexSearchAmenities');
                if (amenitiesSelect) {
                    amenitiesSelect.addEventListener('change', () => {
                        indexApplyFilters(false);
                    });
                }

                // Transaction Type select
                const transactionTypeSelect = document.getElementById('indexSearchTransactionType');
                if (transactionTypeSelect) {
                    transactionTypeSelect.addEventListener('change', (e) => {
                        indexCurrentFilter = e.target.value === 'all' ? 'all' : e.target.value;
                        // Update filter tags without redirecting
                        indexApplyFilters(false);
                    });
                }

                // Status select
                const propertyConditionSelect = document.getElementById('indexSearchPropertyCondition');
                if (propertyConditionSelect) {
                    propertyConditionSelect.addEventListener('change', (e) => {
                        indexSelectedCondition = e.target.value || null;
                        // Update filter tags without redirecting
                        indexApplyFilters(false);
                    });
                }

                // Unit Type select
                const unitTypeSelect = document.getElementById('indexSearchUnitType');
                if (unitTypeSelect) {
                    unitTypeSelect.addEventListener('change', (e) => {
                        const selectedOption = unitTypeSelect.options[unitTypeSelect.selectedIndex];
                        if (selectedOption.value === '') {
                            indexSelectedBHK = null;
                        } else {
                            const bhk = parseInt(selectedOption.dataset.bhk);
                            indexSelectedBHK = bhk;
                        }
                        // Update filter tags without redirecting
                        indexApplyFilters(false);
                    });
                }

                // Category buttons - use multiple selectors to ensure we find them
                let categoryButtons = document.querySelectorAll('#indexPropertiesFilters .category-text-button[data-category]');

                // Fallback: try direct ID selectors
                if (categoryButtons.length === 0) {
                    const residentialBtn = document.getElementById('indexFilterResidential');
                    const commercialBtn = document.getElementById('indexFilterCommercial');
                    if (residentialBtn && commercialBtn) {
                        categoryButtons = [residentialBtn, commercialBtn];
                    } else {
                        // Last resort: try without container selector
                        categoryButtons = document.querySelectorAll('.category-text-button[data-category]');
                    }
                }

                // Function to handle category button click
                function handleCategoryClick(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    const btn = e.currentTarget;
                    const category = btn.getAttribute('data-category') || btn.dataset.category;

                    if (!category || !categorySection) return;

                    const currentActiveCategory = categorySection.getAttribute('data-active-category');

                    if (currentActiveCategory === category) {
                        // Toggle off - deselect category
                        categorySection.removeAttribute('data-active-category');

                        // Hide all subcategory buttons
                        const allSubcategoryContainers = document.querySelectorAll('#indexPropertiesFilters .subcategory-buttons');
                        allSubcategoryContainers.forEach(container => {
                            container.style.display = 'none';
                        });

                        btn.classList.remove('active');
                        indexSelectedCategory = null;
                        const allSubButtons = document.querySelectorAll('#indexPropertiesFilters .subcategory-button');
                        allSubButtons.forEach(b => b.classList.remove('active'));
                    } else {
                        // Toggle on - select category
                        categorySection.setAttribute('data-active-category', category);

                        // Show the appropriate subcategory buttons
                        const allSubcategoryContainers = document.querySelectorAll('#indexPropertiesFilters .subcategory-buttons');
                        allSubcategoryContainers.forEach(container => {
                            const containerCategory = container.getAttribute('data-category');
                            if (containerCategory === category) {
                                container.style.display = 'flex';
                            } else {
                                container.style.display = 'none';
                            }
                        });

                        // Remove active from all category buttons
                        const allCategoryBtns = document.querySelectorAll('#indexPropertiesFilters .category-text-button[data-category]');
                        if (allCategoryBtns.length === 0) {
                            const altBtns = document.querySelectorAll('.category-text-button[data-category]');
                            altBtns.forEach(b => b.classList.remove('active'));
                        } else {
                            allCategoryBtns.forEach(b => b.classList.remove('active'));
                        }
                        // Add active to clicked button
                        btn.classList.add('active');
                        // Clear all subcategory buttons
                        const allSubButtons = document.querySelectorAll('#indexPropertiesFilters .subcategory-button');
                        allSubButtons.forEach(b => b.classList.remove('active'));
                        // Update state
                        indexSelectedCategory = category;
                        indexSelectedPropertyType = null;
                    }
                    updateIndexFilterGroupsByPropertyType();
                    updateIndexPropertiesSearchVisibility();
                    // Update filter tags without redirecting
                    indexApplyFilters(false);
                }

                // Attach event listeners to all found buttons
                categoryButtons.forEach(btn => {
                    if (btn) {
                        btn.addEventListener('click', handleCategoryClick);
                    }
                });

                // Property Type subcategory buttons
                const propertyTypeButtons = document.querySelectorAll('#indexPropertiesFilters .subcategory-button[data-property-type]');
                propertyTypeButtons.forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        e.preventDefault();
                        e.stopPropagation();
                        const propType = btn.dataset.propertyType;
                        const parentCategory = btn.dataset.parentCategory;

                        if (indexSelectedPropertyType === propType && indexSelectedCategory === parentCategory) {
                            indexSelectedPropertyType = null;
                            indexSelectedCategory = null;
                            btn.classList.remove('active');
                            const categoryBtn = document.querySelector(`#indexPropertiesFilters .category-text-button[data-category="${parentCategory}"]`);
                            if (categoryBtn) categoryBtn.classList.remove('active');
                            if (categorySection) categorySection.removeAttribute('data-active-category');
                        } else {
                            propertyTypeButtons.forEach(b => b.classList.remove('active'));
                            categoryButtons.forEach(b => b.classList.remove('active'));
                            indexSelectedPropertyType = propType;
                            indexSelectedCategory = parentCategory;
                            btn.classList.add('active');
                            const categoryBtn = document.querySelector(`#indexPropertiesFilters .category-text-button[data-category="${parentCategory}"]`);
                            if (categoryBtn) categoryBtn.classList.add('active');
                            if (categorySection) categorySection.setAttribute('data-active-category', parentCategory);
                        }
                        updateIndexFilterGroupsByPropertyType();
                        updateIndexPropertiesSearchVisibility();
                        // Update filter tags without redirecting
                        indexApplyFilters(false);
                    });
                });

                // Search form submission
                const searchForm = document.getElementById('indexPropertiesSearchForm');
                if (searchForm) {
                    searchForm.addEventListener('submit', (e) => {
                        e.preventDefault();
                        // Redirect when form is submitted
                        indexApplyFilters(true);
                    });

                    const searchInputs = searchForm.querySelectorAll('input, select');
                    searchInputs.forEach(input => {
                        input.addEventListener('change', () => {
                            // Update filter tags without redirecting for input changes
                            indexApplyFilters(false);
                        });

                        if (input.tagName === 'INPUT' && input.type === 'text') {
                            let inputTimeout;
                            input.addEventListener('input', () => {
                                clearTimeout(inputTimeout);
                                inputTimeout = setTimeout(() => {
                                    // Update filter tags without redirecting for text input
                                    indexApplyFilters(false);
                                }, 300);
                            });
                        }
                    });
                }

                // Clear all filters button
                const clearAllBtn = document.getElementById('indexClearAllFilters');
                if (clearAllBtn) {
                    clearAllBtn.addEventListener('click', () => {
                        indexSelectedCondition = null;
                        indexCurrentFilter = 'all';
                        indexSelectedBHK = null;
                        indexSelectedPropertyType = null;
                        indexSelectedCategory = null;

                        if (transactionTypeSelect) transactionTypeSelect.value = 'all';
                        if (propertyConditionSelect) propertyConditionSelect.value = '';
                        if (unitTypeSelect) unitTypeSelect.value = '';

                        document.querySelectorAll('#indexPropertiesFilters .subcategory-button').forEach(btn => btn.classList.remove('active'));
                        document.querySelectorAll('#indexPropertiesFilters .category-text-button').forEach(btn => btn.classList.remove('active'));
                        if (categorySection) categorySection.removeAttribute('data-active-category');
                        updateIndexFilterGroupsByPropertyType();
                        updateIndexPropertiesSearchVisibility();

                        document.getElementById('indexSearchCity').value = '';
                        document.getElementById('indexSearchArea').value = '';
                        document.getElementById('indexSearchAmenities').value = '';
                        document.getElementById('indexSearchDirection').value = '';
                        document.getElementById('indexSearchPrice').value = '';
                        document.getElementById('indexSearchLength').value = '';
                        document.getElementById('indexSearchBreadth').value = '';
                        document.getElementById('indexSearchPlotArea').value = '';
                        document.getElementById('indexSearchCarpetArea').value = '';
                        document.getElementById('indexSearchVillaType').value = '';
                        document.getElementById('indexSearchWarehouseType').value = '';
                        document.getElementById('indexSearchSuperBuildupArea').value = '';

                        // Update filter tags without redirecting when clearing
                        indexApplyFilters(false);
                    });
                }

                // Initialize price range modal
                initIndexPriceRangeModal();
                updateIndexFilterGroupsByPropertyType();
                updateIndexPropertiesSearchVisibility();
            }

            // Apply filters (optionally redirects to properties page with filters)
            function indexApplyFilters(shouldRedirect = false) {
                // Update filter tags first
                indexUpdateFilterTags();

                // Only redirect if explicitly requested (e.g., form submission, search button click)
                if (shouldRedirect) {
                    const params = new URLSearchParams();

                    if (indexCurrentFilter !== 'all') {
                        params.set('status', indexCurrentFilter);
                    }


                    if (indexSelectedPropertyType) {
                        params.set('type', indexSelectedPropertyType);
                    }

                    if (indexSelectedCategory && !indexSelectedPropertyType) {
                        params.set('category', indexSelectedCategory);
                    }

                    const city = document.getElementById('indexSearchCity')?.value.trim() || '';
                    if (city) params.set('city', city);

                    const area = document.getElementById('indexSearchArea')?.value.trim() || '';
                    if (area) params.set('area', area);

                    const amenities = document.getElementById('indexSearchAmenities')?.value.trim() || '';
                    if (amenities) params.set('amenities', amenities);

                    const direction = document.getElementById('indexSearchDirection')?.value.trim() || '';
                    if (direction) params.set('direction', direction);

                    const price = document.getElementById('indexSearchPrice')?.value || '';
                    if (price) params.set('price', price);

                    if (indexSelectedCondition) {
                        params.set('condition', indexSelectedCondition);
                    }

                    if (indexSelectedBHK !== null) {
                        params.set('bhk', indexSelectedBHK);
                    }

                    const length = document.getElementById('indexSearchLength')?.value.trim() || '';
                    if (length) params.set('length', length);

                    const breadth = document.getElementById('indexSearchBreadth')?.value.trim() || '';
                    if (breadth) params.set('breadth', breadth);

                    const plotArea = document.getElementById('indexSearchPlotArea')?.value.trim() || '';
                    if (plotArea) params.set('plot_area', plotArea);

                    const carpetArea = document.getElementById('indexSearchCarpetArea')?.value.trim() || '';
                    if (carpetArea) params.set('carpet_area', carpetArea);

                    const villaType = document.getElementById('indexSearchVillaType')?.value.trim() || '';
                    if (villaType) params.set('villa_type', villaType);

                    const warehouseType = document.getElementById('indexSearchWarehouseType')?.value.trim() || '';
                    if (warehouseType) params.set('warehouse_type', warehouseType);

                    const superBuildupArea = document.getElementById('indexSearchSuperBuildupArea')?.value.trim() || '';
                    if (superBuildupArea) params.set('super_buildup_area', superBuildupArea);

                    // Redirect to properties page with filters
                    const queryString = params.toString();
                    if (queryString) {
                        window.location.href = '/properties.html?' + queryString;
                    } else {
                        window.location.href = '/properties.html';
                    }
                }
            }

            // Update filter tags display
            function indexUpdateFilterTags() {
                const filterTagsContainer = document.getElementById('indexFilterTagsContainer');
                const filterTags = document.getElementById('indexFilterTags');

                if (!filterTagsContainer || !filterTags) return;

                const activeFilters = [];

                if (indexCurrentFilter !== 'all') {
                    activeFilters.push({
                        type: 'status',
                        label: indexCurrentFilter === 'sale' ? 'Buy' : 'Rent',
                        icon: indexCurrentFilter === 'sale' ? 'fa-shopping-cart' : 'fa-key',
                        value: indexCurrentFilter
                    });
                }

                if (indexSelectedCondition) {
                    activeFilters.push({
                        type: 'condition',
                        label: indexSelectedCondition === 'new' ? 'New' : 'Resale',
                        icon: 'fa-certificate',
                        value: indexSelectedCondition
                    });
                }

                if (indexSelectedBHK !== null) {
                    const unitTypeSelect = document.getElementById('indexSearchUnitType');
                    const selectedOption = unitTypeSelect?.options[unitTypeSelect.selectedIndex];
                    const unitType = selectedOption?.value;
                    let unitTypeLabel = '';
                    if (unitType === 'rk') {
                        unitTypeLabel = '1RK';
                    } else if (unitType === '4plus') {
                        unitTypeLabel = '4+BHK';
                    } else {
                        unitTypeLabel = `${indexSelectedBHK}BHK`;
                    }
                    activeFilters.push({
                        type: 'bhk',
                        label: `Unit Type: ${unitTypeLabel}`,
                        icon: 'fa-bed',
                        value: indexSelectedBHK.toString()
                    });
                }

                if (indexSelectedPropertyType) {
                    const typeLabels = {
                        'plots': 'Plots',
                        'apartment': 'Apartments',
                        'office-space': 'Office Space',
                        'warehouse': 'Warehouse',
                        'showrooms': 'Showrooms',
                        'house': 'Individual House',
                        'villa': 'Villas',
                        'row-house': 'Row Houses'
                    };
                    const categoryLabel = indexSelectedCategory === 'residential' ? 'Residential' :
                        indexSelectedCategory === 'commercial' ? 'Commercial' : '';
                    const typeLabel = typeLabels[indexSelectedPropertyType] || indexSelectedPropertyType;
                    activeFilters.push({
                        type: 'propertyType',
                        label: categoryLabel ? `${categoryLabel}: ${typeLabel}` : `Type: ${typeLabel}`,
                        icon: 'fa-building',
                        value: indexSelectedPropertyType
                    });
                } else if (indexSelectedCategory) {
                    activeFilters.push({
                        type: 'category',
                        label: indexSelectedCategory === 'residential' ? 'Residential' : 'Commercial',
                        icon: 'fa-home',
                        value: indexSelectedCategory
                    });
                }

                const city = document.getElementById('indexSearchCity')?.value.trim() || '';
                if (city) {
                    activeFilters.push({
                        type: 'city',
                        label: `City: ${city}`,
                        icon: 'fa-map-marker-alt',
                        value: city
                    });
                }

                const area = document.getElementById('indexSearchArea')?.value.trim() || '';
                if (area) {
                    activeFilters.push({
                        type: 'area',
                        label: `Area: ${area}`,
                        icon: 'fa-map-marker-alt',
                        value: area
                    });
                }

                const direction = document.getElementById('indexSearchDirection')?.value.trim() || '';
                if (direction) {
                    const directionLabels = { east: 'East', west: 'West', north: 'North', south: 'South', northeast: 'North East', northwest: 'North West', southeast: 'South East', southwest: 'South West' };
                    activeFilters.push({
                        type: 'direction',
                        label: `Direction: ${directionLabels[direction] || direction}`,
                        icon: 'fa-compass',
                        value: direction
                    });
                }

                const price = document.getElementById('indexSearchPrice')?.value || '';
                if (price) {
                    activeFilters.push({
                        type: 'price',
                        label: `Price: Custom Range`,
                        icon: 'fa-rupee-sign',
                        value: price
                    });
                }

                const amenities = document.getElementById('indexSearchAmenities')?.value.trim() || '';
                if (amenities) {
                    activeFilters.push({
                        type: 'amenities',
                        label: `Amenities: ${amenities}`,
                        icon: 'fa-star',
                        value: amenities
                    });
                }

                const length = document.getElementById('indexSearchLength')?.value.trim() || '';
                if (length) {
                    activeFilters.push({
                        type: 'length',
                        label: `Length: ${length} ft`,
                        icon: 'fa-arrows-alt-h',
                        value: length
                    });
                }

                const breadth = document.getElementById('indexSearchBreadth')?.value.trim() || '';
                if (breadth) {
                    activeFilters.push({
                        type: 'breadth',
                        label: `Breadth: ${breadth} ft`,
                        icon: 'fa-arrows-alt-v',
                        value: breadth
                    });
                }

                const plotArea = document.getElementById('indexSearchPlotArea')?.value.trim() || '';
                if (plotArea) {
                    activeFilters.push({
                        type: 'plot_area',
                        label: `Plot Area: ${plotArea} sq.ft`,
                        icon: 'fa-ruler-combined',
                        value: plotArea
                    });
                }

                const carpetArea = document.getElementById('indexSearchCarpetArea')?.value.trim() || '';
                if (carpetArea) {
                    activeFilters.push({
                        type: 'carpet_area',
                        label: `Carpet Area: ${carpetArea} sq.ft`,
                        icon: 'fa-vector-square',
                        value: carpetArea
                    });
                }
                if (activeFilters.length > 0) {
                    filterTags.innerHTML = activeFilters.map(filter => `
                        <div class="filter-tag" data-filter-type="${filter.type}" data-filter-value="${filter.value || ''}">
                            <i class="fas ${filter.icon} filter-tag-icon"></i>
                            <span class="filter-tag-text">${filter.label}</span>
                            <button type="button" class="filter-tag-remove" data-filter-type="${filter.type}">
                                <i class="fas fa-times"></i>
                            </button>
                        </div>
                    `).join('');
                    filterTagsContainer.style.display = 'block';

                    // Add event listeners to remove buttons
                    filterTags.querySelectorAll('.filter-tag-remove').forEach(btn => {
                        btn.addEventListener('click', (e) => {
                            e.stopPropagation();
                            const filterType = btn.dataset.filterType;
                            indexRemoveFilter(filterType);
                        });
                    });
                } else {
                    filterTagsContainer.style.display = 'none';
                    filterTags.innerHTML = '';
                }
            }

            // Remove Filter
            function indexRemoveFilter(filterType) {
                switch (filterType) {
                    case 'status':
                        indexCurrentFilter = 'all';
                        const transactionTypeSelect = document.getElementById('indexSearchTransactionType');
                        if (transactionTypeSelect) transactionTypeSelect.value = 'all';
                        break;
                    case 'condition':
                        indexSelectedCondition = null;
                        const propertyConditionSelect = document.getElementById('indexSearchPropertyCondition');
                        if (propertyConditionSelect) propertyConditionSelect.value = '';
                        break;
                    case 'bhk':
                        indexSelectedBHK = null;
                        const unitTypeSelect = document.getElementById('indexSearchUnitType');
                        if (unitTypeSelect) unitTypeSelect.value = '';
                        break;
                    case 'propertyType':
                        indexSelectedPropertyType = null;
                        indexSelectedCategory = null;
                        document.querySelectorAll('#indexPropertiesFilters .subcategory-button[data-property-type]').forEach(btn => btn.classList.remove('active'));
                        document.querySelectorAll('#indexPropertiesFilters .category-text-button[data-category]').forEach(btn => btn.classList.remove('active'));
                        const categorySection = document.querySelector('#indexCategorySection');
                        if (categorySection) categorySection.removeAttribute('data-active-category');
                        break;
                    case 'category':
                        indexSelectedCategory = null;
                        indexSelectedPropertyType = null;
                        document.querySelectorAll('#indexPropertiesFilters .category-text-button[data-category]').forEach(btn => btn.classList.remove('active'));
                        document.querySelectorAll('#indexPropertiesFilters .subcategory-button[data-property-type]').forEach(btn => btn.classList.remove('active'));
                        const categorySection2 = document.querySelector('#indexCategorySection');
                        if (categorySection2) categorySection2.removeAttribute('data-active-category');
                        break;
                    case 'city':
                        const cityInput = document.getElementById('indexSearchCity');
                        if (cityInput) cityInput.value = '';
                        break;
                    case 'area':
                        const areaInput = document.getElementById('indexSearchArea');
                        if (areaInput) areaInput.value = '';
                        break;
                    case 'direction':
                        const directionInput = document.getElementById('indexSearchDirection');
                        if (directionInput) directionInput.value = '';
                        break;
                    case 'price':
                        const priceSelect = document.getElementById('indexSearchPrice');
                        if (priceSelect) priceSelect.value = '';
                        const priceRangeDisplay = document.getElementById('indexPriceRangeDisplay');
                        if (priceRangeDisplay) priceRangeDisplay.textContent = 'Any Price';
                        break;
                    case 'amenities':
                        const amenitiesSelect = document.getElementById('indexSearchAmenities');
                        if (amenitiesSelect) amenitiesSelect.value = '';
                        break;
                    case 'length':
                        const lengthInput = document.getElementById('indexSearchLength');
                        if (lengthInput) lengthInput.value = '';
                        break;
                    case 'breadth':
                        const breadthInput = document.getElementById('indexSearchBreadth');
                        if (breadthInput) breadthInput.value = '';
                        break;
                    case 'plot_area':
                        const plotAreaInput = document.getElementById('indexSearchPlotArea');
                        if (plotAreaInput) plotAreaInput.value = '';
                        break;
                    case 'carpet_area':
                        const carpetAreaInput = document.getElementById('indexSearchCarpetArea');
                        if (carpetAreaInput) carpetAreaInput.value = '';
                        break;
                }
                const indexFiltersRoot = document.getElementById('indexPropertiesFilters');
                if (indexFiltersRoot) {
                    if (indexSelectedPropertyType) indexFiltersRoot.setAttribute('data-show-search', 'true');
                    else indexFiltersRoot.removeAttribute('data-show-search');
                }
                // Update filter tags without redirecting
                indexApplyFilters(false);
            }

            // Initialize Price Range Modal for Index Page
            function initIndexPriceRangeModal() {
                const priceRangeBtn = document.getElementById('indexPriceRangeBtn');
                const priceRangeModal = document.getElementById('indexPriceRangeModal');
                const priceRangeModalOverlay = document.getElementById('indexPriceRangeModalOverlay');
                const priceRangeModalClose = document.getElementById('indexPriceRangeModalClose');
                const priceRangeMin = document.getElementById('indexPriceRangeMin');
                const priceRangeMax = document.getElementById('indexPriceRangeMax');
                const priceRangeMinInput = document.getElementById('indexPriceRangeMinInput');
                const priceRangeMaxInput = document.getElementById('indexPriceRangeMaxInput');
                const priceRangeProgress = document.getElementById('indexPriceRangeProgress');
                const priceRangeLabelMin = document.getElementById('indexPriceRangeLabelMin');
                const priceRangeLabelMax = document.getElementById('indexPriceRangeLabelMax');
                const priceRangeDisplay = document.getElementById('indexPriceRangeDisplay');
                const priceRangeBtnClear = document.getElementById('indexPriceRangeBtnClear');
                const priceRangeBtnApply = document.getElementById('indexPriceRangeBtnApply');
                const searchPriceInput = document.getElementById('indexSearchPrice');

                if (!priceRangeBtn || !priceRangeModal) return;

                let minValue = 0;
                let maxValue = 100;

                function crToPrice(cr) {
                    return cr * 10000000;
                }

                function priceToCr(price) {
                    return price / 10000000;
                }

                function formatPriceDisplay(minCr, maxCr) {
                    if (minCr === 0 && maxCr === 100) {
                        return 'Any Price';
                    }
                    if (maxCr >= 100) {
                        return `₹${minCr > 0 ? minCr.toFixed(1) : '0'} Cr+`;
                    }
                    return `₹${minCr > 0 ? minCr.toFixed(1) : '0'} Cr - ₹${maxCr.toFixed(1)} Cr`;
                }

                function updateProgress() {
                    const minPercent = (minValue / 100) * 100;
                    const maxPercent = (maxValue / 100) * 100;
                    if (priceRangeProgress) {
                        priceRangeProgress.style.left = minPercent + '%';
                        priceRangeProgress.style.right = (100 - maxPercent) + '%';
                    }
                }

                function updateLabels() {
                    if (priceRangeLabelMin) {
                        priceRangeLabelMin.textContent = minValue === 0 ? '₹0' : `₹${minValue.toFixed(1)} Cr`;
                    }
                    if (priceRangeLabelMax) {
                        priceRangeLabelMax.textContent = maxValue >= 100 ? '₹100+ Cr' : `₹${maxValue.toFixed(1)} Cr`;
                    }
                }

                function updateSliderFromInput() {
                    if (priceRangeMin) priceRangeMin.value = minValue;
                    if (priceRangeMax) priceRangeMax.value = maxValue;
                    updateProgress();
                    updateLabels();
                }

                function updateInputFromSlider() {
                    if (priceRangeMinInput) priceRangeMinInput.value = minValue;
                    if (priceRangeMaxInput) priceRangeMaxInput.value = maxValue;
                    updateProgress();
                    updateLabels();
                }

                function validateRange() {
                    if (minValue > maxValue) {
                        const temp = minValue;
                        minValue = maxValue;
                        maxValue = temp;
                    }
                    if (minValue < 0) minValue = 0;
                    if (maxValue > 100) maxValue = 100;
                }

                function openModal() {
                    if (priceRangeModal) {
                        priceRangeModal.classList.add('active');
                        document.body.style.overflow = 'hidden';
                    }
                }

                function closeModal() {
                    if (priceRangeModal) {
                        priceRangeModal.classList.remove('active');
                        document.body.style.overflow = '';
                    }
                }

                function applyPriceRange() {
                    validateRange();
                    const minPrice = crToPrice(minValue);
                    const maxPrice = maxValue >= 100 ? '' : crToPrice(maxValue);
                    const priceValue = maxPrice === '' ? `${minPrice}-` : `${minPrice}-${maxPrice}`;

                    if (searchPriceInput) {
                        if (minValue === 0 && maxValue >= 100) {
                            searchPriceInput.value = '';
                        } else {
                            searchPriceInput.value = priceValue;
                        }
                    }

                    if (priceRangeDisplay) {
                        priceRangeDisplay.textContent = formatPriceDisplay(minValue, maxValue);
                    }

                    closeModal();
                    indexUpdateFilterTags();
                }

                function clearPriceRange() {
                    minValue = 0;
                    maxValue = 100;
                    updateSliderFromInput();
                    if (searchPriceInput) {
                        searchPriceInput.value = '';
                    }
                    if (priceRangeDisplay) {
                        priceRangeDisplay.textContent = 'Any Price';
                    }
                    closeModal();
                    indexUpdateFilterTags();
                }

                if (priceRangeBtn) {
                    priceRangeBtn.addEventListener('click', openModal);
                }

                if (priceRangeModalOverlay) {
                    priceRangeModalOverlay.addEventListener('click', closeModal);
                }

                if (priceRangeModalClose) {
                    priceRangeModalClose.addEventListener('click', closeModal);
                }

                document.addEventListener('keydown', (e) => {
                    if (e.key === 'Escape' && priceRangeModal && priceRangeModal.classList.contains('active')) {
                        closeModal();
                    }
                });

                if (priceRangeMin) {
                    priceRangeMin.addEventListener('input', (e) => {
                        minValue = parseFloat(e.target.value);
                        validateRange();
                        updateInputFromSlider();
                    });
                }

                if (priceRangeMax) {
                    priceRangeMax.addEventListener('input', (e) => {
                        maxValue = parseFloat(e.target.value);
                        validateRange();
                        updateInputFromSlider();
                    });
                }

                if (priceRangeMinInput) {
                    priceRangeMinInput.addEventListener('input', (e) => {
                        minValue = parseFloat(e.target.value) || 0;
                        validateRange();
                        updateSliderFromInput();
                    });
                }

                if (priceRangeMaxInput) {
                    priceRangeMaxInput.addEventListener('input', (e) => {
                        maxValue = parseFloat(e.target.value) || 100;
                        validateRange();
                        updateSliderFromInput();
                    });
                }

                if (priceRangeBtnClear) {
                    priceRangeBtnClear.addEventListener('click', clearPriceRange);
                }

                if (priceRangeBtnApply) {
                    priceRangeBtnApply.addEventListener('click', applyPriceRange);
                }

                function initializeFromFilter() {
                    if (searchPriceInput && searchPriceInput.value) {
                        const priceValue = searchPriceInput.value;
                        if (priceValue.includes('-')) {
                            const [min, max] = priceValue.split('-').map(v => v === '' ? Infinity : parseFloat(v));
                            minValue = priceToCr(min || 0);
                            maxValue = max === Infinity ? 100 : priceToCr(max);
                            validateRange();
                            updateSliderFromInput();
                            if (priceRangeDisplay) {
                                priceRangeDisplay.textContent = formatPriceDisplay(minValue, maxValue);
                            }
                        }
                    }
                }

                initializeFromFilter();
                updateProgress();
                updateLabels();
            }

            // Initialize on DOM ready
            if (document.readyState === 'loading') {
                document.addEventListener('DOMContentLoaded', initIndexFilters);
            } else {
                initIndexFilters();
            }
        })();
    </script>
    <script>
        // Suppress browser extension errors that are not related to our code
        window.addEventListener('error', function (event) {
            // Suppress common browser extension errors
            if (event.message && (
                event.message.includes('message channel closed') ||
                event.message.includes('Extension context invalidated') ||
                event.message.includes('Receiving end does not exist') ||
                event.message.includes('asynchronous response') ||
                event.message.includes('message channel closed before a response')
            )) {
                event.preventDefault();
                event.stopPropagation();
                return false;
            }
        }, true);

        // Suppress unhandled promise rejections from browser extensions
        window.addEventListener('unhandledrejection', function (event) {
            if (event.reason && typeof event.reason === 'object' && event.reason.message) {
                const message = event.reason.message;
                if (message.includes('message channel closed') ||
                    message.includes('Extension context invalidated') ||
                    message.includes('Receiving end does not exist') ||
                    message.includes('asynchronous response') ||
                    message.includes('message channel closed before a response')) {
                    event.preventDefault();
                    return false;
                }
            }
            // Also check string errors
            if (typeof event.reason === 'string' && (
                event.reason.includes('message channel closed') ||
                event.reason.includes('Extension context invalidated') ||
                event.reason.includes('asynchronous response') ||
                event.reason.includes('message channel closed before a response')
            )) {
                event.preventDefault();
                return false;
            }
        });
    </script>
    <script>
        document.documentElement.classList.add('loaded');
    </script>
</body>

</html>