<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <title>Dashboard - Tirumakudalu Properties</title>
    <link rel="icon" type="image/png" href="/images/TirumakudaluProperties_Logo-2048x1858.png">
    <link rel="stylesheet" href="/css/style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=Playfair+Display:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://cdn.quilljs.com/1.3.7/quill.snow.css" rel="stylesheet">
    <style>
        /* Hide body content by default - only show after authentication check passes */
        /* Don't hide html element - it can block dev tools */
        body {
            display: none !important;
            visibility: hidden !important;
            opacity: 0 !important;
        }
        body.authenticated {
            display: block !important;
            visibility: visible !important;
            opacity: 1 !important;
        }
        /* Show loading message while checking authentication */
        body::before {
            content: 'Checking authentication...';
            display: block;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-family: Inter, sans-serif;
            color: #8B2E3D;
            z-index: 9999;
            background: white;
            padding: 2rem;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        body.authenticated::before {
            display: none;
        }
    </style>
</head>
<body>
    <!-- Authentication Check - Must run immediately before any content -->
    <!-- This script runs synchronously and blocks page rendering until authentication is verified -->
    <script>
        // IMMEDIATE SYNCHRONOUS CHECK - No delays, no async operations
        (function() {
            'use strict';
            
            try {
                // Function to clear all authentication data
                function clearAllAuthData() {
                    try {
                        sessionStorage.removeItem('dashboard_authenticated');
                        sessionStorage.removeItem('isAuthenticated');
                        sessionStorage.removeItem('user');
                        localStorage.removeItem('dashboard_authenticated');
                        localStorage.removeItem('isAuthenticated');
                        localStorage.removeItem('user');
                        // Also clear any session manager tracking data
                        for (let i = localStorage.length - 1; i >= 0; i--) {
                            const key = localStorage.key(i);
                            if (key && (key.startsWith('tab_') || key === 'session_cleared')) {
                                localStorage.removeItem(key);
                            }
                        }
                    } catch (e) {
                        // Ignore errors during cleanup
                    }
                }
                
                // IMMEDIATE CHECK: Get authentication data synchronously
                let localAuth, sessionAuth, localUserStr, sessionUserStr;
                try {
                    localAuth = localStorage.getItem('dashboard_authenticated');
                    sessionAuth = sessionStorage.getItem('dashboard_authenticated');
                    localUserStr = localStorage.getItem('user');
                    sessionUserStr = sessionStorage.getItem('user');
                } catch (e) {
                    // Storage access failed - treat as not authenticated
                    clearAllAuthData();
                    window.location.replace('/index.html');
                    return;
                }
                
                // Check if authentication flag exists
                const isAuthenticated = (localAuth === 'true') || (sessionAuth === 'true');
                
                // Get user data
                const userStr = localUserStr || sessionUserStr;
                
                // Validate user data exists and is valid JSON with required fields
                let hasValidUser = false;
                let user = null;
                
                if (userStr) {
                    try {
                        user = JSON.parse(userStr);
                        // STRICT VALIDATION: Must have email (non-empty string) AND admin role
                        if (user && 
                            user.email && 
                            typeof user.email === 'string' && 
                            user.email.trim() !== '' && 
                            user.role === 'admin') {
                            hasValidUser = true;
                        } else {
                            // Invalid user data
                            user = null;
                            hasValidUser = false;
                        }
                    } catch (e) {
                        // Invalid JSON
                        user = null;
                        hasValidUser = false;
                    }
                }
                
                // CRITICAL CHECK: Both authentication flag AND valid user data must exist
                // If either is missing or invalid, redirect immediately
                if (!isAuthenticated || !hasValidUser || !user) {
                    // Clear all authentication data
                    clearAllAuthData();
                    // Redirect immediately - use replace to prevent back button
                    try {
                        window.location.replace('/index.html');
                    } catch (e) {
                        try {
                            window.location.href = '/index.html';
                        } catch (e2) {
                            // Last resort - show error and redirect
                            if (document.body) {
                                document.body.style.display = 'block';
                                document.body.innerHTML = '<div style="font-family: Inter, sans-serif; display: flex; justify-content: center; align-items: center; height: 100vh; text-align: center;"><div><h1>Unauthorized Access</h1><p>Redirecting to login...</p></div></div>';
                                setTimeout(function() {
                                    window.location.href = '/index.html';
                                }, 1000);
                            }
                        }
                    }
                    return;
                }
                
                // ADDITIONAL SECURITY: Double-check that we have valid data
                if (!user.email || typeof user.email !== 'string' || user.email.trim() === '') {
                    clearAllAuthData();
                    window.location.replace('/index.html');
                    return;
                }
                
                if (user.role !== 'admin') {
                    clearAllAuthData();
                    window.location.replace('/index.html');
                    return;
                }
                
                // Authentication passed - mark body as authenticated
                // Use multiple methods to ensure the class is added reliably
                function addAuthenticatedClass() {
                    try {
                        if (document.body) {
                            document.body.classList.add('authenticated');
                            // Also add to html element for good measure
                            if (document.documentElement) {
                                document.documentElement.classList.add('authenticated');
                            }
                            return true;
                        }
                    } catch (e) {
                        // Ignore errors
                    }
                    return false;
                }
                
                // Try immediately (body might exist if script runs after body tag)
                addAuthenticatedClass();
                
                // Also set up listeners for when body becomes available
                if (document.readyState === 'loading') {
                    // Document is still loading - wait for DOMContentLoaded
                    document.addEventListener('DOMContentLoaded', function() {
                        addAuthenticatedClass();
                    });
                } else {
                    // Document is already loaded or interactive - try immediately and on next tick
                    addAuthenticatedClass();
                    setTimeout(function() {
                        addAuthenticatedClass();
                    }, 0);
                }
                
                // Fallback: Use readystatechange for older browsers
                if (document.attachEvent) {
                    document.attachEvent('onreadystatechange', function() {
                        if (document.readyState === 'complete' || document.readyState === 'interactive') {
                            addAuthenticatedClass();
                        }
                    });
                }
                
                // Final fallback: Force show after a short delay if authentication passed
                setTimeout(function() {
                    try {
                        if (document.body && !document.body.classList.contains('authenticated')) {
                            // Authentication passed but class wasn't added - add it now
                            addAuthenticatedClass();
                        }
                    } catch (e) {
                        // Ignore errors
                    }
                }, 100);
                
            } catch (error) {
                // If any error occurs, show error message and redirect
                console.error('Authentication check error:', error);
                try {
                    window.location.replace('/index.html');
                } catch (e) {
                    // Show error and redirect
                    try {
                        if (document.body) {
                            document.body.style.display = 'block';
                            document.body.innerHTML = '<div style="font-family: Inter, sans-serif; display: flex; justify-content: center; align-items: center; height: 100vh; text-align: center;"><div><h1>Error</h1><p>An error occurred. Redirecting to login...</p></div></div>';
                            setTimeout(function() {
                                window.location.href = '/index.html';
                            }, 2000);
                        } else {
                            window.location.href = '/index.html';
                        }
                    } catch (e2) {
                        window.location.href = '/index.html';
                    }
                }
            }
        })();
    </script>
    <!-- Fallback: If JavaScript is disabled, redirect via meta refresh -->
    <noscript>
        <meta http-equiv="refresh" content="0; url=/index.html">
    </noscript>
    
    <!-- Dashboard (shown when authenticated) -->
    <div class="dashboard-container" id="dashboardContainer">
        <!-- Dashboard Header -->
        <header class="dashboard-header">
            <div class="dashboard-header-content">
                <div class="dashboard-header-left">
                    <a href="/" class="dashboard-logo-link">
                        <div class="logo-graphic">
                            <img src="/images/TirumakudaluProperties_Logo-2048x1858.png" alt="Tirumakudalu Properties Logo" class="logo-img">
                        </div>
                    </a>
                    <!-- Dashboard Navigation -->
                    <nav class="dashboard-nav">
                        <ul class="dashboard-nav-menu">
                            <li><a href="/index.html">HOME</a></li>
                            <li><a href="/properties.html">PROPERTIES</a></li>
                        </ul>
                    </nav>
                </div>
                <div class="dashboard-header-right">
                    <!-- User Profile Dropdown -->
                    <div class="dashboard-user-profile" id="dashboardUserProfile">
                        <button class="dashboard-profile-btn" id="dashboardProfileBtn">
                            <div class="dashboard-profile-avatar">
                                <i class="fas fa-user"></i>
                            </div>
                            <span class="dashboard-profile-name" id="dashboardProfileName">Admin</span>
                            <i class="fas fa-chevron-down dashboard-profile-chevron"></i>
                        </button>
                        <div class="dashboard-profile-dropdown" id="dashboardProfileDropdown">
                            <div class="dashboard-profile-header">
                                <div class="dashboard-profile-avatar-large">
                                    <i class="fas fa-user"></i>
                                </div>
                                <div class="dashboard-profile-info">
                                    <div class="dashboard-profile-fullname" id="dashboardProfileFullname">Admin User</div>
                                    <div class="dashboard-profile-email" id="dashboardProfileEmail">admin@example.com</div>
                                </div>
                            </div>
                            <div class="dashboard-profile-divider"></div>
                            <a href="/settings.html" class="dashboard-profile-item">
                                <i class="fas fa-cog"></i>
                                <span>Settings</span>
                            </a>
                            <a href="/activity-logs.html" class="dashboard-profile-item">
                                <i class="fas fa-history"></i>
                                <span>Activity Logs</span>
                            </a>
                            <button class="dashboard-profile-item dashboard-profile-logout" id="dashboardLogout">
                                <i class="fas fa-sign-out-alt"></i>
                                <span>Logout</span>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </header>

        <!-- Dashboard Main Content -->
        <main class="dashboard-main">
            <div class="dashboard-content">
                <!-- Welcome Message -->
                <div class="dashboard-welcome">
                    <h1 class="dashboard-welcome-title">
                        <i class="fas fa-hand-sparkles"></i>
                        Welcome to Tirumakudalu Dashboard
                    </h1>
                    <p class="dashboard-welcome-subtitle">Manage your properties, inquiries, and content from one central location</p>
                </div>

                <!-- Dashboard Stats -->
                <div class="dashboard-stats">
                    <div class="dashboard-stat-card" data-stat-type="total_properties" data-stat-label="Total Properties">
                        <div class="dashboard-stat-icon">
                            <i class="fas fa-building"></i>
                        </div>
                        <div class="dashboard-stat-info">
                            <h3 id="totalProperties">0</h3>
                            <p>Total Properties</p>
                        </div>
                    </div>
                    <div class="dashboard-stat-card" data-stat-type="for_sale" data-stat-label="For Sale">
                        <div class="dashboard-stat-icon sale">
                            <i class="fas fa-tag"></i>
                        </div>
                        <div class="dashboard-stat-info">
                            <h3 id="saleProperties">0</h3>
                            <p>For Sale</p>
                        </div>
                    </div>
                    <div class="dashboard-stat-card" data-stat-type="for_rent" data-stat-label="For Rent">
                        <div class="dashboard-stat-icon rent">
                            <i class="fas fa-key"></i>
                        </div>
                        <div class="dashboard-stat-info">
                            <h3 id="rentProperties">0</h3>
                            <p>For Rent</p>
                        </div>
                    </div>
                    <div class="dashboard-stat-card" data-stat-type="total_logs" data-stat-label="Clicks Log">
                        <div class="dashboard-stat-icon">
                            <i class="fas fa-list-alt"></i>
                        </div>
                        <div class="dashboard-stat-info">
                            <h3 id="totalLogs">0</h3>
                            <p>Clicks Log</p>
                        </div>
                    </div>
                </div>

                <!-- Properties Table -->
                <div class="dashboard-properties-section">
                    <div class="dashboard-section-header">
                        <h2>Properties</h2>
                        <div style="display: flex; gap: 1rem; align-items: center;">
                            <div class="dashboard-search-box">
                                <i class="fas fa-search"></i>
                                <input type="text" id="propertySearch" placeholder="Search properties...">
                            </div>
                            <input type="file" id="importPropertiesFile" accept=".csv" style="display: none;">
                            <button class="dashboard-export dashboard-import" id="importPropertiesBtn" title="Import Properties from CSV" style="white-space: nowrap;">
                                <i class="fas fa-upload"></i>
                                IMPORT CSV
                            </button>
                            <button class="dashboard-export" id="exportPropertiesBtn" title="Export Properties to CSV" style="white-space: nowrap;">
                                <i class="fas fa-download"></i>
                                EXPORT CSV
                            </button>
                        </div>
                    </div>
                    <div class="dashboard-actions" style="margin-bottom: 1.5rem;">
                        <button class="dashboard-btn-primary" id="addPropertyBtn">
                            <i class="fas fa-plus"></i>
                            Add Property
                        </button>
                    </div>
                    <div class="dashboard-properties-table-container properties-table-scrollable">
                        <table class="dashboard-properties-table">
                            <thead>
                                <tr>
                                    <th>Image</th>
                                    <th>Title</th>
                                    <th>Location</th>
                                    <th>Type</th>
                                    <th>Price</th>
                                    <th>Status</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="propertiesTableBody">
                                <!-- Properties will be loaded here -->
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Testimonials Section -->
                <div class="dashboard-properties-section">
                    <div class="dashboard-section-header">
                        <h2>Testimonials</h2>
                        <div style="display: flex; gap: 1rem; align-items: center;">
                            <div class="dashboard-search-box">
                                <i class="fas fa-search"></i>
                                <input type="text" id="testimonialSearch" placeholder="Search testimonials...">
                            </div>
                            <input type="file" id="importTestimonialsFile" accept=".csv" style="display: none;">
                            <button class="dashboard-export dashboard-import" id="importTestimonialsBtn" title="Import Testimonials from CSV" style="white-space: nowrap;">
                                <i class="fas fa-upload"></i>
                                IMPORT CSV
                            </button>
                            <button class="dashboard-export" id="exportTestimonialsBtn" title="Export Testimonials to CSV" style="white-space: nowrap;">
                                <i class="fas fa-download"></i>
                                EXPORT CSV
                            </button>
                        </div>
                    </div>
                    <div class="dashboard-actions" style="margin-bottom: 1.5rem;">
                        <button class="dashboard-btn-primary" id="addTestimonialBtn">
                            <i class="fas fa-plus"></i>
                            Add New Testimonial
                        </button>
                    </div>
                    <div class="dashboard-properties-table-container properties-table-scrollable">
                        <table class="dashboard-properties-table">
                            <thead>
                                <tr>
                                    <th>Client Name</th>
                                    <th>Email</th>
                                    <th>Service Type</th>
                                    <th>Rating</th>
                                    <th>Message</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="testimonialsTableBody">
                                <!-- Testimonials will be loaded here -->
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Partners Section -->
                <div class="dashboard-properties-section">
                    <div class="dashboard-section-header">
                        <h2>Partners</h2>
                        <div style="display: flex; gap: 1rem; align-items: center;">
                            <div class="dashboard-search-box">
                                <i class="fas fa-search"></i>
                                <input type="text" id="partnerSearch" placeholder="Search partners...">
                            </div>
                            <input type="file" id="importPartnersFile" accept=".csv" style="display: none;">
                            <button class="dashboard-export dashboard-import" id="importPartnersBtn" title="Import Partners from CSV" style="white-space: nowrap;">
                                <i class="fas fa-upload"></i>
                                IMPORT CSV
                            </button>
                            <button class="dashboard-export" id="exportPartnersBtn" title="Export Partners to CSV" style="white-space: nowrap;">
                                <i class="fas fa-download"></i>
                                EXPORT CSV
                            </button>
                        </div>
                    </div>
                    <div class="dashboard-actions" style="margin-bottom: 1.5rem;">
                        <button class="dashboard-btn-primary" id="addPartnerBtn">
                            <i class="fas fa-plus"></i>
                            Add New Partner
                        </button>
                    </div>
                    <div class="dashboard-properties-table-container">
                        <table class="dashboard-properties-table">
                            <thead>
                                <tr>
                                    <th>Logo</th>
                                    <th>Name</th>
                                    <th>Website</th>
                                    <th>Display Order</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="partnersTableBody">
                                <!-- Partners will be loaded here -->
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Blogs Section -->
                <div class="dashboard-properties-section">
                    <div class="dashboard-section-header">
                        <h2>
                            <i class="fas fa-blog" style="margin-right: 0.5rem;"></i>
                            Blogs
                        </h2>
                        <div style="display: flex; gap: 1rem; align-items: center;">
                            <div class="dashboard-search-box">
                                <i class="fas fa-search"></i>
                                <input type="text" id="blogSearch" placeholder="Search blogs...">
                            </div>
                            <input type="file" id="importBlogsFile" accept=".csv" style="display: none;">
                            <button class="dashboard-export dashboard-import" id="importBlogsBtn" title="Import Blogs from CSV" style="white-space: nowrap;">
                                <i class="fas fa-upload"></i>
                                IMPORT CSV
                            </button>
                            <button class="dashboard-export" id="exportBlogsBtn" title="Export Blogs to CSV" style="white-space: nowrap;">
                                <i class="fas fa-download"></i>
                                EXPORT CSV
                            </button>
                        </div>
                    </div>
                    <div class="dashboard-actions" style="margin-bottom: 1.5rem;">
                        <button class="dashboard-btn-primary" id="addBlogBtn">
                            <i class="fas fa-plus"></i>
                            Add New Blog
                        </button>
                    </div>
                    <div class="dashboard-properties-table-container properties-table-scrollable">
                        <table class="dashboard-properties-table">
                            <thead>
                                <tr>
                                    <th>Image</th>
                                    <th>Title</th>
                                    <th>Category</th>
                                    <th>Author</th>
                                    <th>Views</th>
                                    <th>Status</th>
                                    <th>Created</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="blogsTableBody">
                                <!-- Blogs will be loaded here -->
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Schedule Visit Requests Section -->
                <div class="dashboard-properties-section">
                    <div class="dashboard-section-header">
                        <h2>
                            <i class="fas fa-calendar-check" style="margin-right: 0.5rem;"></i>
                            Schedule Visit Requests
                        </h2>
                        <div style="display: flex; gap: 1rem; align-items: center;">
                            <div class="dashboard-search-box">
                                <i class="fas fa-search"></i>
                                <input type="text" id="scheduleVisitSearch" placeholder="Search visit requests...">
                            </div>
                            <input type="file" id="importScheduleVisitsFile" accept=".csv" style="display: none;">
                            <button class="dashboard-export dashboard-import" id="importScheduleVisitsBtn" title="Import Schedule Visit Requests from CSV" style="white-space: nowrap;">
                                <i class="fas fa-upload"></i>
                                IMPORT CSV
                            </button>
                            <button class="dashboard-export" id="exportScheduleVisitsBtn" title="Export Schedule Visit Requests to CSV" style="white-space: nowrap;">
                                <i class="fas fa-download"></i>
                                EXPORT CSV
                            </button>
                        </div>
                    </div>
                    <div class="dashboard-properties-table-container schedule-visit-table-container">
                        <table class="dashboard-properties-table">
                            <thead>
                                <tr>
                                    <th>Name</th>
                                    <th>Email</th>
                                    <th>Phone</th>
                                    <th>Property</th>
                                    <th>Visit Details</th>
                                    <th>IP Address</th>
                                    <th>Date</th>
                                    <th>Status</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="scheduleVisitTableBody">
                                <!-- Schedule Visit requests will be loaded here -->
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Contact Inquiries Section -->
                <div class="dashboard-properties-section">
                    <div class="dashboard-section-header">
                        <h2>
                            <i class="fas fa-envelope" style="margin-right: 0.5rem;"></i>
                            Contact Inquiries
                        </h2>
                        <div style="display: flex; gap: 1rem; align-items: center;">
                            <div class="dashboard-search-box">
                                <i class="fas fa-search"></i>
                                <input type="text" id="contactInquirySearch" placeholder="Search contact inquiries...">
                            </div>
                            <input type="file" id="importContactInquiriesFile" accept=".csv" style="display: none;">
                            <button class="dashboard-export dashboard-import" id="importContactInquiriesBtn" title="Import Contact Inquiries from CSV" style="white-space: nowrap;">
                                <i class="fas fa-upload"></i>
                                IMPORT CSV
                            </button>
                            <button class="dashboard-export" id="exportContactInquiriesBtn" title="Export Contact Inquiries to CSV" style="white-space: nowrap;">
                                <i class="fas fa-download"></i>
                                EXPORT CSV
                            </button>
                        </div>
                    </div>
                    <div class="dashboard-properties-table-container contact-inquiry-table-container">
                        <table class="dashboard-properties-table">
                            <thead>
                                <tr>
                                    <th>Name</th>
                                    <th>Email</th>
                                    <th>Phone</th>
                                    <th>Subject</th>
                                    <th>Message</th>
                                    <th>Property</th>
                                    <th>IP Address</th>
                                    <th>Date</th>
                                    <th>Status</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="contactInquiryTableBody">
                                <!-- Contact inquiries will be loaded here -->
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Visitor Info Section -->
                <div class="dashboard-properties-section">
                    <div class="dashboard-section-header">
                        <h2>
                            <i class="fas fa-users" style="margin-right: 0.5rem;"></i>
                            Website Visitors
                        </h2>
                        <div style="display: flex; gap: 1rem; align-items: center;">
                            <div class="dashboard-search-box">
                                <i class="fas fa-search"></i>
                                <input type="text" id="visitorSearch" placeholder="Search visitors...">
                            </div>
                            <input type="file" id="importVisitorsFile" accept=".csv" style="display: none;">
                            <button class="dashboard-export dashboard-import" id="importVisitorsBtn" title="Import Website Visitors from CSV" style="white-space: nowrap;">
                                <i class="fas fa-upload"></i>
                                IMPORT CSV
                            </button>
                            <button class="dashboard-export" id="exportVisitorsBtn" title="Export Website Visitors to CSV" style="white-space: nowrap;">
                                <i class="fas fa-download"></i>
                                EXPORT CSV
                            </button>
                        </div>
                    </div>
                    <div class="dashboard-properties-table-container">
                        <table class="dashboard-properties-table">
                            <thead>
                                <tr>
                                    <th>Full Name</th>
                                    <th>Email</th>
                                    <th>Phone</th>
                                    <th>Looking For</th>
                                    <th>IP Address</th>
                                    <th>Date</th>
                                </tr>
                            </thead>
                            <tbody id="visitorInfoTableBody">
                                <!-- Visitor info will be loaded here -->
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Page Visit Counts Section -->
                <div class="dashboard-properties-section">
                    <div class="dashboard-section-header">
                        <h2>
                            <i class="fas fa-chart-line" style="margin-right: 0.5rem;"></i>
                            Page Visit Counts
                        </h2>
                    </div>
                    <div class="dashboard-properties-table-container">
                        <table class="dashboard-properties-table">
                            <thead>
                                <tr>
                                    <th>Page Name</th>
                                    <th>Total Visits</th>
                                    <th>Unique Visitors</th>
                                    <th>Authenticated Visitors</th>
                                </tr>
                            </thead>
                            <tbody id="pageVisitsTableBody">
                                <tr>
                                    <td colspan="4" style="text-align: center; padding: 2rem;">
                                        <i class="fas fa-spinner fa-spin"></i> Loading page visit statistics...
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Add/Edit Partner Modal -->
    <div class="dashboard-modal" id="partnerModal">
        <div class="dashboard-modal-overlay" id="partnerModalOverlay"></div>
        <div class="dashboard-modal-content">
            <div class="dashboard-modal-header">
                <h2 id="partnerModalTitle">Add New Partner</h2>
                <button class="dashboard-modal-close" id="partnerModalClose">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <form class="dashboard-property-form" id="partnerForm">
                <input type="hidden" id="partnerId" name="id">
                
                <div class="dashboard-form-row">
                    <div class="dashboard-form-group">
                        <label for="partnerName">
                            <i class="fas fa-building"></i>
                            Partner Name *
                        </label>
                        <input type="text" id="partnerName" name="name" placeholder="e.g., L&T Realty" required>
                    </div>
                    <div class="dashboard-form-group">
                        <label for="partnerWebsite">
                            <i class="fas fa-globe"></i>
                            Website URL
                        </label>
                        <input type="url" id="partnerWebsite" name="website_url" placeholder="e.g., https://example.com">
                    </div>
                </div>

                <div class="dashboard-form-row">
                    <div class="dashboard-form-group">
                        <label for="partnerDisplayOrder">
                            <i class="fas fa-sort-numeric-down"></i>
                            Display Order
                        </label>
                        <input type="number" id="partnerDisplayOrder" name="display_order" placeholder="e.g., 1" min="0" value="0">
                    </div>
                    <div class="dashboard-form-group">
                        <label style="display: flex; align-items: center; gap: 0.5rem; margin-top: 2rem;">
                            <input type="checkbox" id="partnerIsActive" name="is_active" style="width: auto;" checked>
                            <span>Active</span>
                        </label>
                    </div>
                </div>

                <div class="dashboard-form-group">
                    <label>
                        <i class="fas fa-image"></i>
                        Partner Logo (PNG or SVG only, Max 2 files) *
                    </label>
                    <div class="dashboard-image-upload-area" id="partnerLogoUploadArea">
                        <input type="file" id="partnerLogos" name="logos" multiple accept="image/png,image/svg+xml,.png,.svg" style="display: none;">
                        <div class="dashboard-image-upload-placeholder" id="partnerLogoUploadPlaceholder">
                            <i class="fas fa-cloud-upload-alt"></i>
                            <p>Click to upload logo(s) or drag and drop</p>
                            <span>Supports: PNG, SVG only (Max 2 files, 5MB per file)</span>
                        </div>
                        <div class="dashboard-image-preview-container" id="partnerLogoPreviewContainer"></div>
                    </div>
                </div>

                <div class="dashboard-modal-actions">
                    <button type="button" class="dashboard-btn-secondary" id="cancelPartnerBtn">Cancel</button>
                    <button type="submit" class="dashboard-btn-primary">
                        <i class="fas fa-save"></i>
                        Save Partner
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Add/Edit Testimonial Modal -->
    <div class="dashboard-modal" id="testimonialModal">
        <div class="dashboard-modal-overlay" id="testimonialModalOverlay"></div>
        <div class="dashboard-modal-content">
            <div class="dashboard-modal-header">
                <h2 id="testimonialModalTitle">Add New Testimonial</h2>
                <button class="dashboard-modal-close" id="testimonialModalClose">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <form class="dashboard-property-form" id="testimonialForm">
                <input type="hidden" id="testimonialId" name="id">
                
                <div class="dashboard-form-row">
                    <div class="dashboard-form-group">
                        <label for="testimonialClientName">
                            <i class="fas fa-user"></i>
                            Client Name *
                        </label>
                        <input type="text" id="testimonialClientName" name="client_name" placeholder="e.g., John Doe" required>
                    </div>
                    <div class="dashboard-form-group">
                        <label for="testimonialClientEmail">
                            <i class="fas fa-envelope"></i>
                            Email
                        </label>
                        <input type="email" id="testimonialClientEmail" name="client_email" placeholder="e.g., john@example.com">
                    </div>
                </div>

                <div class="dashboard-form-row">
                    <div class="dashboard-form-group">
                        <label for="testimonialClientPhone">
                            <i class="fas fa-phone"></i>
                            Phone
                        </label>
                        <input type="text" id="testimonialClientPhone" name="client_phone" placeholder="e.g., +1234567890">
                    </div>
                    <div class="dashboard-form-group">
                        <label for="testimonialServiceType">
                            <i class="fas fa-briefcase"></i>
                            Service Type
                        </label>
                        <input type="text" id="testimonialServiceType" name="service_type" placeholder="e.g., Property Purchase">
                    </div>
                </div>

                <div class="dashboard-form-row">
                    <div class="dashboard-form-group">
                        <label for="testimonialRating">
                            <i class="fas fa-star"></i>
                            Rating (1-5)
                        </label>
                        <select id="testimonialRating" name="rating">
                            <option value="">Select Rating</option>
                            <option value="1">1 Star</option>
                            <option value="2">2 Stars</option>
                            <option value="3">3 Stars</option>
                            <option value="4">4 Stars</option>
                            <option value="5">5 Stars</option>
                        </select>
                    </div>
                </div>

                <div class="dashboard-form-group">
                    <label for="testimonialMessage">
                        <i class="fas fa-comment"></i>
                        Message *
                    </label>
                    <textarea id="testimonialMessage" name="message" rows="5" placeholder="Enter testimonial message..." required></textarea>
                </div>

                <div class="dashboard-form-row">
                    <div class="dashboard-form-group">
                        <label style="display: flex; align-items: center; gap: 0.5rem;">
                            <input type="checkbox" id="testimonialIsApproved" name="is_approved" style="width: auto;">
                            <span>Approved</span>
                        </label>
                    </div>
                </div>

                <div class="dashboard-modal-actions">
                    <button type="button" class="dashboard-btn-secondary" id="cancelTestimonialBtn">Cancel</button>
                    <button type="submit" class="dashboard-btn-primary">
                        <i class="fas fa-save"></i>
                        Save Testimonial
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Add/Edit Property Modal - Step by Step -->
    <div class="dashboard-modal" id="propertyModal">
        <div class="dashboard-modal-overlay" id="propertyModalOverlay"></div>
        <div class="dashboard-modal-content" style="max-width: 1200px; width: 90vw; max-height: 90vh; overflow-y: auto;">
            <div class="dashboard-modal-header" style="padding: 2rem 2.5rem 1.5rem;">
                <h2 id="propertyModalTitle" style="font-size: 1.75rem; margin: 0;">Add New Property</h2>
                <button class="dashboard-modal-close" id="propertyModalClose">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <!-- Step Indicator -->
            <div class="property-wizard-steps" style="display: flex; justify-content: center; gap: 2rem; margin: 0 2.5rem 3rem; padding: 2rem 0; border-bottom: 1px solid var(--border-color); flex-wrap: wrap;">
                <div class="property-wizard-step active" data-step="1" style="display: flex; align-items: center; gap: 0.75rem;">
                    <div class="property-wizard-step-number" style="width: 40px; height: 40px; border-radius: 50%; background: var(--primary-color); color: white; display: flex; align-items: center; justify-content: center; font-weight: 600; font-size: 1.1rem;">1</div>
                    <span class="property-wizard-step-label" style="font-weight: 500; font-size: 1rem;">Basic Information</span>
                </div>
                <div class="property-wizard-step-divider" style="width: 80px; height: 2px; background: var(--border-color); margin-top: 20px;"></div>
                <div class="property-wizard-step" data-step="2" style="display: flex; align-items: center; gap: 0.75rem;">
                    <div class="property-wizard-step-number" style="width: 40px; height: 40px; border-radius: 50%; background: var(--border-color); color: var(--text-gray); display: flex; align-items: center; justify-content: center; font-weight: 600; font-size: 1.1rem;">2</div>
                    <span class="property-wizard-step-label" style="font-weight: 500; color: var(--text-gray); font-size: 1rem;">Property Details</span>
                </div>
                <div class="property-wizard-step-divider" style="width: 80px; height: 2px; background: var(--border-color); margin-top: 20px;"></div>
                <div class="property-wizard-step" data-step="3" style="display: flex; align-items: center; gap: 0.75rem;">
                    <div class="property-wizard-step-number" style="width: 40px; height: 40px; border-radius: 50%; background: var(--border-color); color: var(--text-gray); display: flex; align-items: center; justify-content: center; font-weight: 600; font-size: 1.1rem;">3</div>
                    <span class="property-wizard-step-label" style="font-weight: 500; color: var(--text-gray); font-size: 1rem;">Additional Details</span>
                </div>
            </div>

            <form class="dashboard-property-form" id="propertyForm" style="padding: 0 2.5rem 2.5rem;">
                <input type="hidden" id="propertyId" name="id">
                <input type="hidden" id="currentStep" value="1">
                
                <!-- Step 1: Basic Information -->
                <div class="property-wizard-step-content" id="step1" data-step="1">
                    <div class="dashboard-form-row" style="margin-bottom: 1.5rem;">
                        <div class="dashboard-form-group" style="flex: 1; margin-right: 1.5rem;">
                            <label for="propertyProjectName" style="font-size: 1rem; margin-bottom: 0.75rem; font-weight: 500;">
                                <i class="fas fa-building"></i>
                                Project Name *
                            </label>
                            <input type="text" id="propertyProjectName" name="project_name" placeholder="e.g., Luxury Apartments" required style="padding: 1rem 1.25rem; font-size: 1rem;">
                        </div>
                        <div class="dashboard-form-group" style="flex: 1;">
                            <label for="propertyCity" style="font-size: 1rem; margin-bottom: 0.75rem; font-weight: 500;">
                                <i class="fas fa-city"></i>
                                City *
                            </label>
                            <input type="text" id="propertyCity" name="city" placeholder="e.g., Bengaluru" required style="padding: 1rem 1.25rem; font-size: 1rem;">
                        </div>
                    </div>

                    <div class="dashboard-form-row" style="margin-bottom: 1.5rem;">
                        <div class="dashboard-form-group" style="flex: 1; margin-right: 1.5rem;">
                            <label for="propertyLocality" style="font-size: 1rem; margin-bottom: 0.75rem; font-weight: 500;">
                                <i class="fas fa-map-marker-alt"></i>
                                Locality / Area *
                            </label>
                            <input type="text" id="propertyLocality" name="locality" placeholder="e.g., Whitefield" required style="padding: 1rem 1.25rem; font-size: 1rem;">
                        </div>
                        <div class="dashboard-form-group" style="flex: 1;">
                            <label for="propertyLocationLink" style="font-size: 1rem; margin-bottom: 0.75rem; font-weight: 500;">
                                <i class="fas fa-link"></i>
                                Location Link (Google Maps)
                            </label>
                            <input type="url" id="propertyLocationLink" name="location_link" placeholder="e.g., https://maps.google.com/..." style="padding: 1rem 1.25rem; font-size: 1rem;">
                        </div>
                    </div>

                    <div class="dashboard-form-row" style="margin-bottom: 0;">
                        <div class="dashboard-form-group" style="flex: 1;">
                            <label for="propertyType" style="font-size: 1rem; margin-bottom: 0.75rem; font-weight: 500;">
                                <i class="fas fa-home"></i>
                                Property Type *
                            </label>
                            <select id="propertyType" name="type" required style="padding: 1rem 1.25rem; font-size: 1rem;">
                                <option value="">Select Property Type</option>
                                <option value="apartments">Apartments</option>
                                <option value="villas">Villas</option>
                                <option value="plot_properties">Plot Properties</option>
                                <option value="individual_house">Individual House</option>
                            </select>
                        </div>
                    </div>
                </div>

                <!-- Step 2: Property Details (Dynamic based on property type) -->
                <div class="property-wizard-step-content" id="step2" data-step="2" style="display: none;">
                    <div id="step2Content">
                        <!-- Content will be dynamically populated based on property type -->
                    </div>
                </div>

                <!-- Step 3: Additional Details (Will be configured in next prompt) -->
                <div class="property-wizard-step-content" id="step3" data-step="3" style="display: none;">
                    <div id="step3Content">
                        <!-- Content will be configured in next prompt -->
                    </div>
                </div>

                <!-- Navigation Buttons -->
                <div class="dashboard-modal-actions" style="display: flex; justify-content: flex-end; margin-top: 3rem; padding-top: 2rem; border-top: 1px solid var(--border-color);">
                    <div style="display: flex; gap: 1rem;">
                        <button type="button" class="dashboard-btn-secondary" id="prevStepBtn" style="display: none; padding: 0.875rem 2rem; font-size: 1rem;">
                            <i class="fas fa-arrow-left"></i>
                            Previous
                        </button>
                        <button type="button" class="dashboard-btn-primary" id="nextStepBtn" style="padding: 0.875rem 2rem; font-size: 1rem;">
                            Next
                            <i class="fas fa-arrow-right"></i>
                        </button>
                        <button type="submit" class="dashboard-btn-primary" id="submitPropertyBtn" style="display: none; padding: 0.875rem 2rem; font-size: 1rem;">
                            <i class="fas fa-save"></i>
                            Save Property
                        </button>
                    </div>
                </div>
            </form>
        </div>
    </div>

    <!-- Add/Edit Blog Modal -->
    <div class="dashboard-modal" id="blogModal">
        <div class="dashboard-modal-overlay" id="blogModalOverlay"></div>
        <div class="dashboard-modal-content">
            <div class="dashboard-modal-header">
                <h2 id="blogModalTitle">Add New Blog</h2>
                <button class="dashboard-modal-close" id="blogModalClose">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <form class="dashboard-property-form" id="blogForm">
                <input type="hidden" id="blogId" name="id">
                
                <div class="dashboard-form-row">
                    <div class="dashboard-form-group">
                        <label for="blogTitle">
                            <i class="fas fa-heading"></i>
                            Blog Title *
                        </label>
                        <input type="text" id="blogTitle" name="title" placeholder="e.g., Top 10 Real Estate Investment Tips" required>
                    </div>
                    <div class="dashboard-form-group">
                        <label for="blogCategory">
                            <i class="fas fa-tags"></i>
                            Category
                        </label>
                        <select id="blogCategory" name="category">
                            <option value="">Select Category</option>
                            <option value="real-estate">Real Estate</option>
                            <option value="investment">Investment</option>
                            <option value="property-management">Property Management</option>
                            <option value="market-trends">Market Trends</option>
                            <option value="tips">Tips & Advice</option>
                            <option value="news">News & Updates</option>
                        </select>
                    </div>
                </div>

                <div class="dashboard-form-row">
                    <div class="dashboard-form-group">
                        <label for="blogAuthor">
                            <i class="fas fa-user"></i>
                            Author
                        </label>
                        <input type="text" id="blogAuthor" name="author" placeholder="e.g., Tirumakudalu Properties" value="Tirumakudalu Properties">
                    </div>
                </div>

                <div class="dashboard-form-group">
                    <label>
                        <i class="fas fa-image"></i>
                        Blog Image *
                    </label>
                    <div class="dashboard-image-upload-area" id="blogImageUploadArea">
                        <input type="file" id="blogImage" name="image" accept="image/*" style="display: none;">
                        <div class="dashboard-image-upload-placeholder" id="blogImageUploadPlaceholder">
                            <i class="fas fa-cloud-upload-alt"></i>
                            <p>Click to upload image or drag and drop</p>
                            <span>Supports: JPG, PNG, GIF, WebP (Max 5MB)</span>
                        </div>
                        <div class="dashboard-image-preview-container" id="blogImagePreviewContainer"></div>
                    </div>
                </div>

                <div class="dashboard-form-group">
                    <label for="blogExcerpt">
                        <i class="fas fa-align-left"></i>
                        Excerpt *
                    </label>
                    <textarea id="blogExcerpt" name="excerpt" rows="3" placeholder="Enter a brief summary of the blog post..." required></textarea>
                </div>

                <div class="dashboard-form-group">
                    <label for="blogContent">
                        <i class="fas fa-file-alt"></i>
                        Content *
                    </label>
                    <div id="blogContentEditor" style="min-height: 300px;"></div>
                    <textarea id="blogContent" name="content" style="display: none;"></textarea>
                </div>

                <div class="dashboard-form-group">
                    <label>
                        <i class="fas fa-tags"></i>
                        Tags
                    </label>
                    <div class="dashboard-features-container">
                        <div class="dashboard-features-input-wrapper">
                            <input type="text" id="blogTagInput" placeholder="Add a tag (e.g., bengaluru, investment, etc.)">
                            <button type="button" class="dashboard-btn-add-feature" id="addBlogTagBtn">
                                <i class="fas fa-plus"></i>
                                Add
                            </button>
                        </div>
                        <div class="dashboard-features-list" id="blogTagsList"></div>
                    </div>
                </div>

                <div class="dashboard-form-row">
                    <div class="dashboard-form-group">
                        <label style="display: flex; align-items: center; gap: 0.5rem;">
                            <input type="checkbox" id="blogIsFeatured" name="is_featured" style="width: auto;">
                            <span>Featured</span>
                        </label>
                    </div>
                    <div class="dashboard-form-group">
                        <label style="display: flex; align-items: center; gap: 0.5rem;">
                            <input type="checkbox" id="blogIsActive" name="is_active" style="width: auto;" checked>
                            <span>Active</span>
                        </label>
                    </div>
                </div>

                <div class="dashboard-modal-actions">
                    <button type="button" class="dashboard-btn-secondary" id="cancelBlogBtn">Cancel</button>
                    <button type="submit" class="dashboard-btn-primary">
                        <i class="fas fa-save"></i>
                        Save Blog
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Delete Confirmation Modal -->
    <div class="dashboard-modal" id="deleteModal">
        <div class="dashboard-modal-overlay" id="deleteModalOverlay"></div>
        <div class="dashboard-modal-content dashboard-modal-small">
            <div class="dashboard-modal-header">
                <h2 id="deleteModalTitle">Delete Property</h2>
                <button class="dashboard-modal-close" id="deleteModalClose">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="dashboard-modal-body">
                <p id="deleteModalMessage">Are you sure you want to delete this property? This action cannot be undone.</p>
            </div>
            <div class="dashboard-modal-actions">
                <button type="button" class="dashboard-btn-secondary" id="cancelDeleteBtn">Cancel</button>
                <button type="button" class="dashboard-btn-danger" id="confirmDeleteBtn">
                    <i class="fas fa-trash"></i>
                    Delete
                </button>
            </div>
        </div>
    </div>

    <!-- Contact Inquiry View Modal -->
    <div class="dashboard-modal" id="contactInquiryViewModal">
        <div class="dashboard-modal-overlay" id="contactInquiryViewModalOverlay"></div>
        <div class="dashboard-modal-content" style="max-width: 800px;">
            <div class="dashboard-modal-header">
                <h2>
                    <i class="fas fa-envelope" style="margin-right: 0.5rem;"></i>
                    Contact Inquiry Details
                </h2>
                <button class="dashboard-modal-close" id="contactInquiryViewModalClose">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="dashboard-modal-body" style="padding: 2rem;">
                <div class="contact-inquiry-view-content">
                    <!-- Status Badge -->
                    <div class="contact-inquiry-status-section" style="margin-bottom: 2rem;">
                        <label class="contact-inquiry-label">Status</label>
                        <div id="contactInquiryViewStatus" class="status-badge"></div>
                    </div>

                    <!-- Inquiry Information Grid -->
                    <div class="contact-inquiry-info-grid">
                        <div class="contact-inquiry-info-item">
                            <div class="contact-inquiry-icon">
                                <i class="fas fa-user"></i>
                            </div>
                            <div class="contact-inquiry-info-content">
                                <label class="contact-inquiry-label">Name</label>
                                <p class="contact-inquiry-value" id="contactInquiryViewName">-</p>
                            </div>
                        </div>

                        <div class="contact-inquiry-info-item">
                            <div class="contact-inquiry-icon">
                                <i class="fas fa-envelope"></i>
                            </div>
                            <div class="contact-inquiry-info-content">
                                <label class="contact-inquiry-label">Email</label>
                                <p class="contact-inquiry-value">
                                    <a href="#" id="contactInquiryViewEmail" style="color: var(--primary-color); text-decoration: none;">-</a>
                                </p>
                            </div>
                        </div>

                        <div class="contact-inquiry-info-item">
                            <div class="contact-inquiry-icon">
                                <i class="fas fa-phone"></i>
                            </div>
                            <div class="contact-inquiry-info-content">
                                <label class="contact-inquiry-label">Phone</label>
                                <p class="contact-inquiry-value" id="contactInquiryViewPhone">-</p>
                            </div>
                        </div>

                        <div class="contact-inquiry-info-item">
                            <div class="contact-inquiry-icon">
                                <i class="fas fa-tag"></i>
                            </div>
                            <div class="contact-inquiry-info-content">
                                <label class="contact-inquiry-label">Subject</label>
                                <p class="contact-inquiry-value" id="contactInquiryViewSubject">-</p>
                            </div>
                        </div>

                        <div class="contact-inquiry-info-item">
                            <div class="contact-inquiry-icon">
                                <i class="fas fa-building"></i>
                            </div>
                            <div class="contact-inquiry-info-content">
                                <label class="contact-inquiry-label">Property</label>
                                <p class="contact-inquiry-value" id="contactInquiryViewProperty">-</p>
                            </div>
                        </div>

                        <div class="contact-inquiry-info-item">
                            <div class="contact-inquiry-icon">
                                <i class="fas fa-globe"></i>
                            </div>
                            <div class="contact-inquiry-info-content">
                                <label class="contact-inquiry-label">IP Address</label>
                                <p class="contact-inquiry-value" id="contactInquiryViewIpAddress">-</p>
                            </div>
                        </div>

                        <div class="contact-inquiry-info-item">
                            <div class="contact-inquiry-icon">
                                <i class="fas fa-calendar"></i>
                            </div>
                            <div class="contact-inquiry-info-content">
                                <label class="contact-inquiry-label">Date Submitted</label>
                                <p class="contact-inquiry-value" id="contactInquiryViewDate">-</p>
                            </div>
                        </div>

                        <div class="contact-inquiry-info-item">
                            <div class="contact-inquiry-icon">
                                <i class="fas fa-clock"></i>
                            </div>
                            <div class="contact-inquiry-info-content">
                                <label class="contact-inquiry-label">Last Updated</label>
                                <p class="contact-inquiry-value" id="contactInquiryViewUpdated">-</p>
                            </div>
                        </div>
                    </div>

                    <!-- Message Section -->
                    <div class="contact-inquiry-message-section" style="margin-top: 2rem;">
                        <label class="contact-inquiry-label">
                            <i class="fas fa-comment-alt" style="margin-right: 0.5rem;"></i>
                            Message
                        </label>
                        <div class="contact-inquiry-message-box" id="contactInquiryViewMessage">
                            -
                        </div>
                    </div>

                    <!-- Status Update Section -->
                    <div class="contact-inquiry-status-update" style="margin-top: 2rem; padding-top: 2rem; border-top: 2px solid var(--primary-lighter);">
                        <label class="contact-inquiry-label">
                            <i class="fas fa-edit" style="margin-right: 0.5rem;"></i>
                            Update Status
                        </label>
                        <select class="dashboard-status-select" id="contactInquiryViewStatusSelect" style="width: 100%; max-width: 300px; margin-top: 0.5rem;">
                            <option value="new">New</option>
                            <option value="read">Read</option>
                            <option value="replied">Replied</option>
                            <option value="closed">Closed</option>
                        </select>
                    </div>
                </div>
            </div>
            <div class="dashboard-modal-actions" style="padding: 1.5rem 2rem; border-top: 2px solid var(--primary-lighter);">
                <button type="button" class="dashboard-btn-secondary" id="contactInquiryViewCloseBtn">Close</button>
                <button type="button" class="dashboard-btn-primary" id="contactInquiryViewUpdateBtn">
                    <i class="fas fa-save"></i>
                    Update Status
                </button>
            </div>
        </div>
    </div>

    <script src="https://cdn.quilljs.com/1.3.7/quill.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <script>
        // Suppress browser extension errors that are not related to our code
        window.addEventListener('error', function(event) {
            // Suppress common browser extension errors
            if (event.message && (
                event.message.includes('message channel closed') ||
                event.message.includes('Extension context invalidated') ||
                event.message.includes('Receiving end does not exist') ||
                event.message.includes('asynchronous response') ||
                event.message.includes('message channel closed before a response')
            )) {
                event.preventDefault();
                event.stopPropagation();
                return false;
            }
        }, true);
        
        // Suppress unhandled promise rejections from browser extensions
        window.addEventListener('unhandledrejection', function(event) {
            if (event.reason && typeof event.reason === 'object' && event.reason.message) {
                const message = event.reason.message;
                if (message.includes('message channel closed') ||
                    message.includes('Extension context invalidated') ||
                    message.includes('Receiving end does not exist') ||
                    message.includes('asynchronous response') ||
                    message.includes('message channel closed before a response')) {
                    event.preventDefault();
                    return false;
                }
            }
            // Also check string errors
            if (typeof event.reason === 'string' && (
                event.reason.includes('message channel closed') ||
                event.reason.includes('Extension context invalidated') ||
                event.reason.includes('asynchronous response') ||
                event.reason.includes('message channel closed before a response')
            )) {
                event.preventDefault();
                return false;
            }
        });
    </script>
    <script src="/js/session-manager.js"></script>
    <script src="/js/dashboard.js?v=20250120120000"></script>
    <script src="/js/page-tracking.js"></script>
</body>
</html>

